"use strict";var Markdown;Markdown="object"==typeof exports&&"function"==typeof require?exports:{},function(){function e(e){return e}function t(){return!1}function n(){}function r(){}n.prototype={"chain":function(t,n){var r=this[t];if(!r)throw new Error("unknown hook "+t);this[t]=r===e?n:function(){var e=Array.prototype.slice.call(arguments,0);return e[0]=r.apply(null,e),n.apply(null,e)}},"set":function(e,t){if(!this[e])throw new Error("unknown hook "+e);this[e]=t},"addNoop":function(t){this[t]=e},"addFalse":function(e){this[e]=t}},Markdown.HookCollection=n,r.prototype={"set":function(e,t){this["s_"+e]=t},"get":function(e){return this["s_"+e]}},Markdown.Converter=function(t){function i(e){return e=e.replace(/^[ ]{0,3}\[([^\[\]]+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(\n+)/gm,function(e,t,n,r,i,o,a){return t=t.toLowerCase(),N.set(t,_(n)),i?r+a:(o&&U.set(t,o.replace(/"/g,"&quot;")),"")})}function o(e){return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,s),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,s),e=e.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,s),e=e.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,s),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,s)}function a(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n§K"+(B.push(e)-1)+"K\n\n"}function s(e,t){return a(t)}function c(e,n,r,i){e=q.preBlockGamut(e,W),t.codeFences&&!i&&(e=w(e)),e=m(e);var a="<hr />\n";return e=e.replace(/^[ ]{0,2}( ?\*){3,}[ \t]*$/gm,a),e=e.replace(/^[ ]{0,2}( ?-){3,}[ \t]*$/gm,a),e=e.replace(/^[ ]{0,2}( ?_){3,}[ \t]*$/gm,a),e=v(e),e=y(e),e=E(e),e=q.postBlockGamut(e,W),e=o(e),e=C(e,n,r)}function u(e){return e=q.preSpanGamut(e),e=x(e),e=l(e),e=T(e),e=h(e),e=f(e),e=M(e),e=e.replace(/§P/g,"://"),e=_(e),e=H(e),e=t.autoNewlines?e.replace(/\n/g,"<br>\n"):e.replace(/  +\n/g," <br>\n"),e=q.postSpanGamut(e)}function l(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=L(t,"!"==e.charAt(1)?"\\`*_/":"\\`*_")})}function f(e){return-1===e.indexOf("[")?e:(e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,d),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,d),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,d))}function d(e,t,n,r,i,o,a,s){void 0==s&&(s="");var c=t,u=n.replace(/:\/\//g,"§P"),l=r.toLowerCase(),f=i,d=s;if(""==f)if(""==l&&(l=u.toLowerCase().replace(/ ?\n/g," ")),f="#"+l,void 0!=N.get(l))f=N.get(l),void 0!=U.get(l)&&(d=U.get(l));else{if(!(c.search(/\(\s*\)$/m)>-1))return c;f=""}f=D(f);var h='<a href="'+f+'"';return""!=d&&(d=p(d),d=L(d,"*_"),h+=' title="'+d+'"'),h+=">"+u+"</a>"}function h(e){return-1===e.indexOf("![")?e:(e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,g),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,g))}function p(e){return e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function g(e,t,n,r,i,o,a,s){var c=t,u=n,l=r.toLowerCase(),f=i,d=s;if(d||(d=""),""==f){if(""==l&&(l=u.toLowerCase().replace(/ ?\n/g," ")),f="#"+l,void 0==N.get(l))return c;f=N.get(l),void 0!=U.get(l)&&(d=U.get(l))}u=L(p(u),"*_[]()"),f=L(f,"*_");var h='<img src="'+f+'" alt="'+u+'"';return d=p(d),d=L(d,"*_"),h+=' title="'+d+'"',h+=" />"}function m(e){return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return"<h1>"+u(t)+"</h1>\n\n"}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return"<h2>"+u(t)+"</h2>\n\n"}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,n){var r=t.length;return"<h"+r+">"+u(n)+"</h"+r+">\n\n"})}function v(e,t){e+="§0";var n=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(§0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return F?e=e.replace(n,function(e,n,r){var i,o=n,a=r.search(/[*+-]/g)>-1?"ul":"ol";"ol"===a&&(i=parseInt(r,10));var s=b(o,a,t);s=s.replace(/\s+$/,"");var c="<"+a;return i&&1!==i&&(c+=' start="'+i+'"'),s=c+">"+s+"</"+a+">\n"}):(n=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(§0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,e=e.replace(n,function(e,t,n,r){var i,o=t,a=n,s=r.search(/[*+-]/g)>-1?"ul":"ol";"ol"===s&&(i=parseInt(r,10));var c=b(a,s),u="<"+s;return i&&1!==i&&(u+=' start="'+i+'"'),c=o+u+">\n"+c+"</"+s+">\n"})),e=e.replace(/§0/,"")}function b(e,t){F++,e=e.replace(/\n{2,}$/,"\n"),e+="§0";var n=K[t],r=new RegExp("(^[ \\t]*)("+n+")[ \\t]+([^\\r]+?(\\n+))(?=(§0|\\1("+n+")[ \\t]+))","gm"),i=!1;return e=e.replace(r,function(e,t,n,r){var o=r,a=/\n\n$/.test(o),s=a||o.search(/\n{2,}/)>-1,u=s||i;return o=c(P(o),!0,!u),i=a,"<li>"+o+"</li>\n"}),e=e.replace(/§0/g,""),F--,e}function y(e){return e+="§0",e=e.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=§0))/g,function(e,t,n){var r=t,i=n;return r=k(P(r)),r=O(r),r=r.replace(/^\n+/g,""),r=r.replace(/\n+$/g,""),r="<pre><code>"+r+"\n</code></pre>","\n\n"+r+"\n\n"+i}),e=e.replace(/§0/,"")}function w(e){return e=e.replace(/(?:\n|^)([ ]{0,3})(([`~])\3{2,})([^`\n]*)(?=\n)([^\r]*?)(?:(\n\n$)|\n([ ]{0,3})\2\3*[ ]*(?=\n|$))/g,function(e,t,n,r,i,o,s){if(o.length&&(o=o.substr(1)),t.length){var c=new RegExp("^[ ]{1,"+t.length+"}","gm");o=o.replace(c,"")}i=i.trim();var u="";/^[a-z0-9#+\-.]+$/i.test(i)&&(u="<!-- language: "+i+" -->\n\n");var l="<pre><code>"+k(o)+"\n</code></pre>";return l=a(l),"\n\n"+u+l+(s||"")})}function x(e){return e=e.replace(/(^|[^\\`])(`+)(?!`)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,r){var i=r;return i=i.replace(/^([ \t]*)/g,""),i=i.replace(/[ \t]*$/g,""),i=k(i),i=i.replace(/:\/\//g,"§P"),t+"<code>"+i+"</code>"})}function k(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=L(e,"*_{}[]\\`~",!1)}function $(e){return-1===e.indexOf("*")&&-1===e.indexOf("_")?e:(e=z(e),e=e.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)\2(?=\S)([^\r]*?\S)\2\2(?!\2)(?=[\W_]|$)/g,"$1<strong>$3</strong>"),e=e.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)(?=\S)((?:(?!\2)[^\r])*?\S)\2(?!\2)(?=[\W_]|$)/g,"$1<em>$3</em>"),V(e))}function S(e){return-1===e.indexOf("*")&&-1===e.indexOf("_")?e:(e=z(e),e=e.replace(/(?=[^\r][*_]|[*_])(^|(?=\W__|(?!\*)[\W_]\*\*|\w\*\*\w)[^\r])(\*\*|__)(?!\2)(?=\S)((?:|[^\r]*?(?!\2)[^\r])(?=\S_|\w|\S\*\*(?:[\W_]|$)).)(?=__(?:\W|$)|\*\*(?:[^*]|$))\2/g,"$1<strong>$3</strong>"),e=e.replace(/(?=[^\r][*_]|[*_])(^|(?=\W_|(?!\*)(?:[\W_]\*|\D\*(?=\w)\D))[^\r])(\*|_)(?!\2\2\2)(?=\S)((?:(?!\2)[^\r])*?(?=[^\s_]_|(?=\w)\D\*\D|[^\s*]\*(?:[\W_]|$)).)(?=_(?:\W|$)|\*(?:[^*]|$))\2/g,"$1<em>$3</em>"),V(e))}function E(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"§0"),n=n.replace(/§0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=c(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"§0"),n=n.replace(/§0/g,"")}),a("<blockquote>\n"+n+"\n</blockquote>")})}function C(e,t,n){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");for(var r=e.split(/\n{2,}/g),i=[],o=/§K(\d+)K/,a=r.length,s=0;a>s;s++){var c=r[s];o.test(c)?i.push(c):/\S/.test(c)&&(c=u(c),c=c.replace(/^([ \t]*)/g,n?"":"<p>"),n||(c+="</p>"),i.push(c))}if(!t){a=i.length;for(var s=0;a>s;s++)for(var l=!0;l;)l=!1,i[s]=i[s].replace(/§K(\d+)K/g,function(e,t){return l=!0,B[t]})}return i.join("\n\n")}function _(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?!]|§D)/gi,"&lt;")}function T(e){return e=e.replace(/\\(\\)/g,R),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,R)}function j(e,t,n,r){if(t)return e;if(")"!==r.charAt(r.length-1))return"<"+n+r+">";for(var i=r.match(/[()]/g),o=0,a=0;a<i.length;a++)"("===i[a]?0>=o?o=1:o++:o--;var s="";if(0>o){var c=new RegExp("\\){1,"+-o+"}$");r=r.replace(c,function(e){return s=e,""})}if(s){var u=r.charAt(r.length-1);J.test(u)||(s=u+s,r=r.substr(0,r.length-1))}return"<"+n+r+">"+s}function M(e){e=z(e),e=e.replace(Q,j),e=V(e);var n=function(e,t){var n=D(t);return'<a href="'+n+'">'+q.plainLinkText(t)+"</a>"};return e=e.replace(/<((https?|ftp):[^'">\s]+)>/gi,n),t.linkEmails&&(e=e.replace(/(<|=")?(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)/gi,A),e=e.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(e,t){var n=I(t);return'<a href="mailto:'+n+'">'+n+"</a>"})),e}function A(e){return e?e.length>0&&"<"===e[0]?e:e.length>1&&"="===e[0]&&'"'===e[1]?e:"<"+e+">":""}function I(e){return e=e.replace(/§E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})}function P(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"§0"),e=e.replace(/§0/g,"")}function O(e){if(!/\t/.test(e))return e;var t,n=["    ","   ","  "," "],r=0;return e.replace(/[\n\t]/g,function(e,i){return"\n"===e?(r=i+1,e):(t=(i-r)%4,r=i+1,n[t])})}function D(e){return e=p(e),e=L(e,"*_:()[]")}function L(e,t,n){var r="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(r="\\\\"+r);var i=new RegExp(r,"g");return e=e.replace(i,R)}function R(e,t){var n=t.charCodeAt(0);return"§E"+n+"E"}var q=this.hooks=new n;q.addNoop("plainLinkText"),q.addNoop("preConversion"),q.addNoop("postNormalization"),q.addNoop("preBlockGamut"),q.addNoop("postBlockGamut"),q.addNoop("preSpanGamut"),q.addNoop("postSpanGamut"),q.addNoop("postConversion");var N,U,B,F;t=t||{};var z=e,V=e;t.nonAsciiLetters&&!function(){var e=/[Q\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376-\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u064a\u0660-\u0669\u066e-\u066f\u0671-\u06d3\u06d5\u06e5-\u06e6\u06ee-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07c0-\u07ea\u07f4-\u07f5\u07fa\u0904-\u0939\u093d\u0950\u0958-\u0961\u0966-\u096f\u0971-\u0972\u097b-\u097f\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc-\u09dd\u09df-\u09e1\u09e6-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a66-\u0a6f\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0-\u0ae1\u0ae6-\u0aef\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b66-\u0b6f\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0be6-\u0bef\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58-\u0c59\u0c60-\u0c61\u0c66-\u0c6f\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0-\u0ce1\u0ce6-\u0cef\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60-\u0d61\u0d66-\u0d6f\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e46\u0e50-\u0e59\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0ed0-\u0ed9\u0edc-\u0edd\u0f00\u0f20-\u0f29\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1000-\u102a\u103f-\u1049\u1050-\u1055\u105a-\u105d\u1061\u1065-\u1066\u106e-\u1070\u1075-\u1081\u108e\u1090-\u1099\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u17e0-\u17e9\u1810-\u1819\u1820-\u1877\u1880-\u18a8\u18aa\u1900-\u191c\u1946-\u196d\u1970-\u1974\u1980-\u19a9\u19c1-\u19c7\u19d0-\u19d9\u1a00-\u1a16\u1b05-\u1b33\u1b45-\u1b4b\u1b50-\u1b59\u1b83-\u1ba0\u1bae-\u1bb9\u1c00-\u1c23\u1c40-\u1c49\u1c4d-\u1c7d\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u203f-\u2040\u2054\u2071\u207f\u2090-\u2094\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183-\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2c6f\u2c71-\u2c7d\u2c80-\u2ce4\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3006\u3031-\u3035\u303b-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31b7\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fc3\ua000-\ua48c\ua500-\ua60c\ua610-\ua62b\ua640-\ua65f\ua662-\ua66e\ua67f-\ua697\ua717-\ua71f\ua722-\ua788\ua78b-\ua78c\ua7fb-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8d0-\ua8d9\ua900-\ua925\ua930-\ua946\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa50-\uaa59\uac00-\ud7a3\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe33-\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/g,t="Q".charCodeAt(0),n="A".charCodeAt(0),r="Z".charCodeAt(0),i="a".charCodeAt(0)-r-1;z=function(o){return o.replace(e,function(e){for(var o,a=e.charCodeAt(0),s="";a>0;)o=a%51+n,o>=t&&o++,o>r&&(o+=i),s=String.fromCharCode(o)+s,a=a/51|0;return"Q"+s+"Q"})},V=function(e){return e.replace(/Q([A-PR-Za-z]{1,3})Q/g,function(e,o){for(var a,s=0,c=0;c<o.length;c++)a=o.charCodeAt(c),a>r&&(a-=i),a>t&&a--,a-=n,s=51*s+a;return String.fromCharCode(s)})}}();var H=t.asteriskIntraWordEmphasis?S:$;this.makeHtml=function(e){if(N)throw new Error("Recursive call to converter.makeHtml");return N=new r,U=new r,B=[],F=0,e=q.preConversion(e),e=e.replace(/§/g,"§T"),e=e.replace(/\$/g,"§D"),e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e="\n\n"+e+"\n\n",e=O(e),e=e.replace(/^[ \t]+$/gm,""),e=q.postNormalization(e),e=w(e),e=o(e),e=i(e),e=c(e,!1,!1,!0),e=I(e),e=e.replace(/§D/g,"$$"),e=e.replace(/§T/g,"§"),e=q.postConversion(e),B=U=N=null,e};var W=function(e){return c(e)},K={"ol":"\\d+[.]","ul":"[*+-]"},G="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",Y="[-A-Z0-9+&@#/%=~_|[\\])]",Q=new RegExp('(="|<)?\\b(https?|ftp)(://'+G+"*"+Y+")(?=$|\\W)","gi"),J=new RegExp(Y,"i")}}(),function(){function e(){}function t(e){this.buttonBar=f.getElementById("wmd-button-bar"+e),this.preview=f.getElementById("wmd-preview"+e),this.input=f.getElementById("wmd-input"+e)}function n(e,t){var n,i,o,a=this,s=[],u=0,l="none",f=function(e,t){l!=e&&(l=e,t||h()),g.isIE&&"moving"==l?o=null:i=setTimeout(d,1)},d=function(e){o=new r(t,e),i=void 0};this.setCommandMode=function(){l="command",h(),i=setTimeout(d,0)},this.canUndo=function(){return u>1},this.canRedo=function(){return s[u+1]?!0:!1},this.undo=function(){a.canUndo()&&(n?(n.restore(),n=null):(s[u]=new r(t),s[--u].restore(),e&&e())),l="none",t.input.focus(),d()},this.redo=function(){a.canRedo()&&(s[++u].restore(),e&&e()),l="none",t.input.focus(),d()};var h=function(){var i=o||new r(t);return i?"moving"==l?(n||(n=i),void 0):(n&&(s[u-1].text!=n.text&&(s[u++]=n),n=null),s[u++]=i,s[u+1]=null,e&&e(),void 0):!1},p=function(e){var t=!1;if((e.ctrlKey||e.metaKey)&&!e.altKey){var n=e.charCode||e.keyCode,r=String.fromCharCode(n);switch(r.toLowerCase()){case"y":a.redo(),t=!0;break;case"z":e.shiftKey?a.redo():a.undo(),t=!0}}return t?(e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1),void 0):void 0},m=function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.keyCode;t>=33&&40>=t||t>=63232&&63235>=t?f("moving"):8==t||46==t||127==t?f("deleting"):13==t?f("newlines"):27==t?f("escape"):(16>t||t>20)&&91!=t&&f("typing")}},v=function(){c.addEvent(t.input,"keypress",function(e){!e.ctrlKey&&!e.metaKey||e.altKey||89!=e.keyCode&&90!=e.keyCode||e.preventDefault()});var e=function(){(g.isIE||o&&o.text!=t.input.value)&&void 0==i&&(l="paste",h(),d())};c.addEvent(t.input,"keydown",p),c.addEvent(t.input,"keydown",m),c.addEvent(t.input,"mousedown",function(){f("moving")}),t.input.onpaste=e,t.input.ondrop=e},b=function(){v(),d(!0),h()};b()}function r(t,n){var r=this,i=t.input;this.init=function(){c.isVisible(i)&&(n||!f.activeElement||f.activeElement===i)&&(this.setInputAreaSelectionStartEnd(),this.scrollTop=i.scrollTop,(!this.text&&i.selectionStart||0===i.selectionStart)&&(this.text=i.value))},this.setInputAreaSelection=function(){if(c.isVisible(i))if(void 0===i.selectionStart||g.isOpera){if(f.selection){if(f.activeElement&&f.activeElement!==i)return;i.focus();var e=i.createTextRange();e.moveStart("character",-i.value.length),e.moveEnd("character",-i.value.length),e.moveEnd("character",r.end),e.moveStart("character",r.start),e.select()}}else i.focus(),i.selectionStart=r.start,i.selectionEnd=r.end,i.scrollTop=r.scrollTop},this.setInputAreaSelectionStartEnd=function(){if(t.ieCachedRange||!i.selectionStart&&0!==i.selectionStart){if(f.selection){r.text=c.fixEolChars(i.value);var e=t.ieCachedRange||f.selection.createRange(),n=c.fixEolChars(e.text),o="",a=o+n+o;e.text=a;var s=c.fixEolChars(i.value);e.moveStart("character",-a.length),e.text=n,r.start=s.indexOf(o),r.end=s.lastIndexOf(o)-o.length;var u=r.text.length-c.fixEolChars(i.value).length;if(u){for(e.moveStart("character",-n.length);u--;)n+="\n",r.end+=1;e.text=n}t.ieCachedRange&&(r.scrollTop=t.ieCachedScrollTop),t.ieCachedRange=null,this.setInputAreaSelection()}}else r.start=i.selectionStart,r.end=i.selectionEnd},this.restore=function(){void 0!=r.text&&r.text!=i.value&&(i.value=r.text),this.setInputAreaSelection(),i.scrollTop=r.scrollTop},this.getChunks=function(){var t=new e;return t.before=c.fixEolChars(r.text.substring(0,r.start)),t.startTag="",t.selection=c.fixEolChars(r.text.substring(r.start,r.end)),t.endTag="",t.after=c.fixEolChars(r.text.substring(r.end)),t.scrollTop=r.scrollTop,t},this.setChunks=function(e){e.before=e.before+e.startTag,e.after=e.endTag+e.after,this.start=e.before.length,this.end=e.before.length+e.selection.length,this.text=e.before+e.selection+e.after,this.scrollTop=e.scrollTop},this.init()}function i(e,t,n){var r,i,o,a=3e3,s="delayed",l=function(e,t){c.addEvent(e,"input",t),e.onpaste=t,e.ondrop=t,c.addEvent(e,"keypress",t),c.addEvent(e,"keydown",t)},d=function(){var e=0;return window.innerHeight?e=window.pageYOffset:f.documentElement&&f.documentElement.scrollTop?e=f.documentElement.scrollTop:f.body&&(e=f.body.scrollTop),e},h=function(){if(t.preview){var n=t.input.value;if(!n||n!=o){o=n;var r=(new Date).getTime();n=e.makeHtml(n);var a=(new Date).getTime();i=a-r,$(n)}}},p=function(){if(r&&(clearTimeout(r),r=void 0),"manual"!==s){var e=0;"delayed"===s&&(e=i),e>a&&(e=a),r=setTimeout(h,e)}},m=function(e){return e.scrollHeight<=e.clientHeight?1:e.scrollTop/(e.scrollHeight-e.clientHeight)},v=function(){t.preview&&(t.preview.scrollTop=(t.preview.scrollHeight-t.preview.clientHeight)*m(t.preview))};this.refresh=function(e){e?(o="",h()):p()},this.processingTime=function(){return i};var b,y=!0,w=function(e){var n=t.preview,r=n.parentNode,i=n.nextSibling;r.removeChild(n),n.innerHTML=e,i?r.insertBefore(n,i):r.appendChild(n)},x=function(e){t.preview.innerHTML=e},k=function(e){if(b)return b(e);try{x(e),b=x}catch(t){b=w,b(e)}},$=function(e){var r=u.getTop(t.input)-d();if(t.preview&&(k(e),n()),v(),y)return y=!1,void 0;var i=u.getTop(t.input)-d();g.isIE?setTimeout(function(){window.scrollBy(0,i-r)},0):window.scrollBy(0,i-r)},S=function(){l(t.input,p),h(),t.preview&&(t.preview.scrollTop=0)};S()}function o(e,t,n,i,o,a,s){function u(e,a){if(v.focus(),e.id&&!a){var s=e.id.replace(/^wmd-(\w+)-.*$/,"$1");if(w[s]&&o.hooks.interceptButtonClick(e,s,function(){u(e,!0)}))return}if(e.textOp){n&&n.setCommandMode();var c=new r(t);if(!c)return;var l=c.getChunks(),f=function(){v.focus(),l&&c.setChunks(l),c.restore(),i.refresh()},d=e.textOp(l,f);d||f()}e.execute&&e.execute(n)}function l(e,n){var r="0px",i="-20px",o="-40px",a=e.getElementsByTagName("span")[0];n?(a.style.backgroundPosition=e.XShift+" "+r,e.onmouseover=function(){a.style.backgroundPosition=this.XShift+" "+o},e.onmouseout=function(){a.style.backgroundPosition=this.XShift+" "+r},g.isIE&&(e.onmousedown=function(){f.activeElement&&f.activeElement!==t.input||(t.ieCachedRange=document.selection.createRange(),t.ieCachedScrollTop=t.input.scrollTop)}),e.isHelp||(e.onclick=function(){return this.onmouseout&&this.onmouseout(),u(this),!1})):(a.style.backgroundPosition=e.XShift+" "+i,e.onmouseover=e.onmouseout=e.onclick=function(){})}function d(e){return"string"==typeof e&&(e=o[e]),function(){e.apply(o,arguments)}}function p(){var n=t.buttonBar,r=document.createElement("ul");r.id="wmd-button-row"+e,r.className="wmd-button-row",r=n.appendChild(r);var i=function(t,n,i,o){var a=document.createElement("li");a.className="wmd-button";var s=document.createElement("span");return a.id=t+e,a.appendChild(s),a.title=n,a.XShift=i,o&&(a.textOp=o),l(a,!0),r.appendChild(a),a},o=function(t){var n=document.createElement("li");n.className="wmd-spacer wmd-spacer"+t,n.id="wmd-spacer"+t+e,r.appendChild(n)};b.bold=i("wmd-bold-button",s("bold"),"0px",d("doBold")),b.italic=i("wmd-italic-button",s("italic"),"-20px",d("doItalic")),o(1),b.link=i("wmd-link-button",s("link"),"-40px",d(function(e,t){return this.doLinkOrImage(e,t,!1)})),b.quote=i("wmd-quote-button",s("quote"),"-60px",d("doBlockquote")),b.code=i("wmd-code-button",s("code"),"-80px",d("doCode")),b.image=i("wmd-image-button",s("image"),"-100px",d(function(e,t){return this.doLinkOrImage(e,t,!0)})),o(2),b.olist=i("wmd-olist-button",s("olist"),"-120px",d(function(e,t){this.doList(e,t,!0)})),b.ulist=i("wmd-ulist-button",s("ulist"),"-140px",d(function(e,t){this.doList(e,t,!1)})),b.heading=i("wmd-heading-button",s("heading"),"-160px",d("doHeading")),b.hr=i("wmd-hr-button",s("hr"),"-180px",d("doHorizontalRule")),o(3),b.undo=i("wmd-undo-button",s("undo"),"-200px",null),b.undo.execute=function(e){e&&e.undo()};var c=/win/.test(h.platform.toLowerCase())?s("redo"):s("redomac");b.redo=i("wmd-redo-button",c,"-220px",null),b.redo.execute=function(e){e&&e.redo()};var u=document.createElement("li");if(u.className="wmd-spacer wmd-spacer-max",r.appendChild(u),a){var f=document.createElement("li"),p=document.createElement("span");f.appendChild(p),f.className="wmd-button wmd-help-button",f.id="wmd-help-button"+e,f.XShift="-240px",f.isHelp=!0,f.style.right="0px",f.title=s("help"),f.onclick=a.handler,l(f,!0),r.appendChild(f),b.help=f}m()}function m(){n&&(l(b.undo,n.canUndo()),l(b.redo,n.canRedo()))}var v=t.input,b={};p();var y="keydown";g.isOpera&&(y="keypress"),c.addEvent(v,y,function(e){if((e.ctrlKey||e.metaKey)&&!e.altKey&&!e.shiftKey){var t=e.charCode||e.keyCode,n=String.fromCharCode(t).toLowerCase();switch(n){case"b":u(b.bold);break;case"i":u(b.italic);break;case"l":u(b.link);break;case"q":u(b.quote);break;case"k":u(b.code);break;case"g":u(b.image);break;case"o":u(b.olist);break;case"u":u(b.ulist);break;case"h":u(b.heading);break;case"r":u(b.hr);break;case"y":u(b.redo);break;case"z":e.shiftKey?u(b.redo):u(b.undo);break;default:return}e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1)}}),c.addEvent(v,"keyup",function(e){if(e.shiftKey&&!e.ctrlKey&&!e.metaKey){var t=e.charCode||e.keyCode;if(13===t){var n={};n.textOp=d("doAutoindent"),u(n)}}}),g.isIE&&c.addEvent(v,"keydown",function(e){var t=e.keyCode;return 27===t?!1:void 0});var w={"link":!0,"image":!0};this.setUndoRedoButtonStates=m}function a(e,t,n,r,i){this.hooks=e,this.getString=t,this.converter=n,this.wrapImageInLink=r,this.convertImagesToLinks=i}function s(e){return e.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(e,t,n){var r=!1;return t=t.replace(/%(?:[\da-fA-F]{2})|\?|\+|[^\w\d-.\/[\]]/g,function(e){if(3===e.length&&"%"==e.charAt(0))return e.toUpperCase();switch(e){case"?":return r=!0,"?";case"+":if(r)return"%20"}return encodeURI(e)}),n&&(n=n.trim?n.trim():n.replace(/^\s*/,"").replace(/\s*$/,""),n=n.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n?t+' "'+n+'"':t})}var c={},u={},l={},f=window.document,d=window.RegExp,h=window.navigator,p={"lineLength":72},g={"isIE":/msie/.test(h.userAgent.toLowerCase()),"isIE_5or6":/msie 6/.test(h.userAgent.toLowerCase())||/msie 5/.test(h.userAgent.toLowerCase()),"isOpera":/opera/.test(h.userAgent.toLowerCase())},m={"bold":"Strong <strong> Ctrl+B","boldexample":"strong text","italic":"Emphasis <em> Ctrl+I","italicexample":"emphasized text","link":"Hyperlink <a> Ctrl+L","linkdescription":"enter link description here","linkdialog":'<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',"quote":"Blockquote <blockquote> Ctrl+Q","quoteexample":"Blockquote","code":"Code Sample <pre><code> Ctrl+K","codeexample":"enter code here","image":"Image <img> Ctrl+G","imagedescription":"enter image description here","imagedialog":'<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg "optional title"</p>',"olist":"Numbered List <ol> Ctrl+O","ulist":"Bulleted List <ul> Ctrl+U","litem":"List item","heading":"Heading <h1>/<h2> Ctrl+H","headingexample":"Heading","hr":"Horizontal Rule <hr> Ctrl+R","undo":"Undo - Ctrl+Z","redo":"Redo - Ctrl+Y","redomac":"Redo - Ctrl+Shift+Z","help":"Markdown Editing Help","ok":"OK","cancel":"Cancel"},v="http://",b="http://";Markdown.Editor=function(e,r,s){s=s||{},"function"==typeof s.handler&&(s={"helpButton":s}),s.strings=s.strings||{},s.helpButton&&(s.strings.help=s.strings.help||s.helpButton.title);var c=function(e){return s.strings[e]||m[e]};r=r||"",this.getPostfix=function(){return r};var u=this.hooks=new Markdown.HookCollection;u.addNoop("onPreviewRefresh"),u.addNoop("postBlockquoteCreation"),u.addFalse("insertImageDialog"),u.addNoop("imageConvertedToLink"),u.addFalse("insertLinkDialog"),u.addFalse("interceptButtonClick"),u.addFalse("skipModalBackground"),this.getConverter=function(){return e};var l,d=this;this.run=function(){if(!l){l=new t(r);var h,p,g=new a(u,c,e,s.wrapImageInLink,s.convertImagesToLinks),m=new i(e,l,function(){u.onPreviewRefresh()});/\?noundo/.test(f.location.href)||(h=new n(function(){m.refresh(),p&&p.setUndoRedoButtonStates()},l),this.textOperation=function(e){h.setCommandMode(),e(),d.refreshPreview()}),p=new o(r,l,h,m,g,s.helpButton,c),p.setUndoRedoButtonStates();var v=d.refreshPreview=function(){m.refresh(!0)};v()}}},e.prototype.findTags=function(e,t){var n,r=this;e&&(n=c.extendRegExp(e,"","$"),this.before=this.before.replace(n,function(e){return r.startTag=r.startTag+e,""}),n=c.extendRegExp(e,"^",""),this.selection=this.selection.replace(n,function(e){return r.startTag=r.startTag+e,""})),t&&(n=c.extendRegExp(t,"","$"),this.selection=this.selection.replace(n,function(e){return r.endTag=e+r.endTag,""}),n=c.extendRegExp(t,"^",""),this.after=this.after.replace(n,function(e){return r.endTag=e+r.endTag,""}))},e.prototype.trimWhitespace=function(e){var t,n,r=this;e?t=n="":(t=function(e){return r.before+=e,""},n=function(e){return r.after=e+r.after,""}),this.selection=this.selection.replace(/^(\s*)/,t).replace(/(\s*)$/,n)},e.prototype.skipLines=function(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),e++,t++;var r,i;if(navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag=this.startTag+d.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag=this.endTag+d.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before=this.before+d.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after=this.after+d.$1,this.before){for(r=i="";e--;)r+="\\n?",i+="\n";n&&(r="\\n*"),this.before=this.before.replace(new d(r+"$",""),i)}if(this.after){for(r=i="";t--;)r+="\\n?",i+="\n";n&&(r="\\n*"),this.after=this.after.replace(new d(r,""),i)}},c.isVisible=function(e){return window.getComputedStyle?"none"!==window.getComputedStyle(e,null).getPropertyValue("display"):e.currentStyle?"none"!==e.currentStyle.display:void 0},c.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},c.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},c.fixEolChars=function(e){return e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n")},c.extendRegExp=function(e,t,n){(null===t||void 0===t)&&(t=""),(null===n||void 0===n)&&(n="");var r,i=e.toString();return i=i.replace(/\/([gim]*)$/,function(e,t){return r=t,""}),i=i.replace(/(^\/|\/$)/g,""),i=t+i+n,new d(i,r)},u.getTop=function(e,t){var n=e.offsetTop;if(!t)for(;e=e.offsetParent;)n+=e.offsetTop;return n},u.getHeight=function(e){return e.offsetHeight||e.scrollHeight},u.getWidth=function(e){return e.offsetWidth||e.scrollWidth},u.getPageSize=function(){var e,t,n,r;self.innerHeight&&self.scrollMaxY?(e=f.body.scrollWidth,t=self.innerHeight+self.scrollMaxY):f.body.scrollHeight>f.body.offsetHeight?(e=f.body.scrollWidth,t=f.body.scrollHeight):(e=f.body.offsetWidth,t=f.body.offsetHeight),self.innerHeight?(n=self.innerWidth,r=self.innerHeight):f.documentElement&&f.documentElement.clientHeight?(n=f.documentElement.clientWidth,r=f.documentElement.clientHeight):f.body&&(n=f.body.clientWidth,r=f.body.clientHeight);var i=Math.max(e,n),o=Math.max(t,r);return[i,o,n,r]},l.createBackground=function(){var e=f.createElement("div"),t=e.style;e.className="wmd-prompt-background",t.position="absolute",t.top="0",t.zIndex="8950",g.isIE?t.filter="alpha(opacity=50)":t.opacity="0.5";var n=u.getPageSize();return t.height=n[1]+"px",g.isIE?(t.left=f.documentElement.scrollLeft,t.width=f.documentElement.clientWidth):(t.left="0",t.width="100%"),f.body.appendChild(e),e},l.prompt=function(e,t,n,r,i){var o,a;void 0===t&&(t="");var s=function(e){var t=e.charCode||e.keyCode;return 27===t?(e.stopPropagation&&e.stopPropagation(),l(!0),!1):void 0},l=function(e){c.removeEvent(f.body,"keyup",s);var t=a.value;return e?t=null:(t=t.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(t)||(t="http://"+t)),o.parentNode.removeChild(o),i(t),!1},d=function(n,r){o=f.createElement("div"),o.className="wmd-prompt-dialog",o.style.padding="10px;",o.style.position="fixed",o.style.width="400px",o.style.zIndex="9000";var i=f.createElement("div");i.innerHTML=e,i.style.padding="5px",o.appendChild(i);var d=f.createElement("form"),h=d.style;d.onsubmit=function(){return l(!1)},h.padding="0",h.margin="0",h.cssFloat="left",h.width="100%",h.textAlign="center",h.position="relative",o.appendChild(d),a=f.createElement("input"),a.type="text",a.value=t,h=a.style,h.display="block",h.width="80%",h.marginLeft=h.marginRight="auto",d.appendChild(a);var p=f.createElement("input");p.type="button",p.onclick=function(){return l(!1)},p.value=n,h=p.style,h.margin="10px",h.display="inline",h.width="7em";var m=f.createElement("input");m.type="button",m.onclick=function(){return l(!0)},m.value=r,h=m.style,h.margin="10px",h.display="inline",h.width="7em",d.appendChild(p),d.appendChild(m),c.addEvent(f.body,"keyup",s),o.style.top="50%",o.style.left="50%",o.style.display="block",g.isIE_5or6&&(o.style.position="absolute",o.style.top=f.documentElement.scrollTop+200+"px",o.style.left="50%"),f.body.appendChild(o),o.style.marginTop=-(u.getHeight(o)/2)+"px",o.style.marginLeft=-(u.getWidth(o)/2)+"px"};setTimeout(function(){d(n,r);var e=t.length;if(void 0!==a.selectionStart)a.selectionStart=0,a.selectionEnd=e;else if(a.createTextRange){var i=a.createTextRange();i.collapse(!1),i.moveStart("character",-e),i.moveEnd("character",e),i.select()}a.focus()},0)};var y=a.prototype;
y.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",y.unwrap=function(e){var t=new d("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");e.selection=e.selection.replace(t,"$1 $2")},y.wrap=function(e,t){this.unwrap(e);var n=new d("(.{1,"+t+"})( +|$\\n?)","gm"),r=this;e.selection=e.selection.replace(n,function(e,t){return new d("^"+r.prefixes,"").test(e)?e:t+"\n"}),e.selection=e.selection.replace(/\s+$/,"")},y.doBold=function(e,t){return this.doBorI(e,t,2,this.getString("boldexample"))},y.doItalic=function(e,t){return this.doBorI(e,t,1,this.getString("italicexample"))},y.doBorI=function(e,t,n,r){e.trimWhitespace(),e.selection=e.selection.replace(/\n{2,}/g,"\n");var i=/(\**$)/.exec(e.before)[0],o=/(^\**)/.exec(e.after)[0],a=Math.min(i.length,o.length);if(a>=n&&(2!=a||1!=n))e.before=e.before.replace(d("[*]{"+n+"}$",""),""),e.after=e.after.replace(d("^[*]{"+n+"}",""),"");else if(!e.selection&&o){e.after=e.after.replace(/^([*_]*)/,""),e.before=e.before.replace(/(\s?)$/,"");var s=d.$1;e.before=e.before+o+s}else{e.selection||o||(e.selection=r);var c=1>=n?"*":"**";e.before=e.before+c,e.after=c+e.after}},y.stripLinkDefs=function(e,t){return e=e.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(e,n,r,i,o){return t[n]=e.replace(/\s*$/,""),i?(t[n]=e.replace(/["(](.+?)[")]$/,""),i+o):""})},y.addLinkDef=function(e,t){var n=0,r={};e.before=this.stripLinkDefs(e.before,r),e.selection=this.stripLinkDefs(e.selection,r),e.after=this.stripLinkDefs(e.after,r);for(var i="",o=/\[(\d+)\]/g,a=e.before+e.selection+e.after,s=this.converter.makeHtml(a),c="https://this-is-a-real-link.biz/";-1!=s.indexOf(c);)c+="nicetry/";var u="\n\n",l=a.replace(o,function(e,t,n){return u+=" ["+n+"]: "+c+n+"/unicorn\n","["+n+"]"});s=this.converter.makeHtml(l+u);var f=function(e){return-1!==s.indexOf(c+e+"/unicorn")},d={},h=function(e){var t=e.replace(/^[ ]{0,3}\[(\d+)\]:/,""),r="L_"+t;return r in d?d[r]:(n++,e="  ["+n+"]:"+t,i+="\n"+e,d[r]=n,n)},p=0,g=function(e,t,n){if(!f(p+n))return e;if(r[t]){var i=h(r[t]);return"["+i+"]"}return e},m=e.before.length;e.before=e.before.replace(o,g),p+=m,m=e.selection.length;var v;return t?v=h(t):e.selection=e.selection.replace(o,g),p+=m,e.after=e.after.replace(o,g),e.after&&(e.after=e.after.replace(/\n*$/,"")),e.after||(e.selection=e.selection.replace(/\n*$/,"")),e.after+="\n\n"+i,v},y.doLinkOrImage=function(e,t,n){e.trimWhitespace(),e.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var r,i=this.wrapImageInLink,o=this.convertImagesToLinks;if(!(e.endTag.length>1&&e.startTag.length>0)){if(e.selection=e.startTag+e.selection+e.endTag,e.startTag=e.endTag="",/\n\n/.test(e.selection))return this.addLinkDef(e,null),void 0;var a=this,c=function(c){if(r&&r.parentNode&&r.parentNode.removeChild(r),null!==c){e.selection=(" "+e.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var u=" [999]: "+s(c),l=a.addLinkDef(e,u);(!n||i&&!o)&&(e.startTag="[",e.endTag="]["+l+"]"),n&&(e.startTag+=o?"[":"![",e.endTag="]["+l+"]"+e.endTag),e.selection||(e.selection=n?a.getString("imagedescription"):a.getString("linkdescription")),n&&o&&a.hooks.imageConvertedToLink()}t()};return this.hooks.skipModalBackground(n?"image":"link")||(r=l.createBackground()),n?this.hooks.insertImageDialog(c)||l.prompt(this.getString("imagedialog"),v,this.getString("ok"),this.getString("cancel"),c):this.hooks.insertLinkDialog(c)||l.prompt(this.getString("linkdialog"),b,this.getString("ok"),this.getString("cancel"),c),!0}e.startTag=e.startTag.replace(/!?\[/,""),e.endTag="",this.addLinkDef(e,null)},y.doAutoindent=function(e){var t=this,n=!1;e.before=e.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),e.selection||/^[ \t]*(?:\n|$)/.test(e.after)||(e.after=e.after.replace(/^[^\n]*/,function(t){return e.selection=t,""}),n=!0),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(e.before)&&t.doList&&t.doList(e),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(e.before)&&t.doBlockquote&&t.doBlockquote(e),/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&t.doCode&&t.doCode(e),n&&(e.after=e.selection+e.after,e.selection="")},y.doBlockquote=function(e){e.selection=e.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(t,n,r,i){return e.before+=n,e.after=i+e.after,r}),e.before=e.before.replace(/(>[ \t]*)$/,function(t,n){return e.selection=n+e.selection,""}),e.selection=e.selection.replace(/^(\s|>)+$/,""),e.selection=e.selection||this.getString("quoteexample");var t,n="",r="";if(e.before){for(var i=e.before.replace(/\n$/,"").split("\n"),o=!1,a=0;a<i.length;a++){var s=!1;t=i[a],o=o&&t.length>0,/^>/.test(t)?(s=!0,!o&&t.length>1&&(o=!0)):s=/^[ \t]*$/.test(t)?!0:o,s?n+=t+"\n":(r+=n+t,n="\n")}/(^|\n)>/.test(n)||(r+=n,n="")}e.startTag=n,e.before=r,e.after&&(e.after=e.after.replace(/^\n?/,"\n")),e.after=e.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(t){return e.endTag=t,""});var c=function(t){var n=t?"> ":"";e.startTag&&(e.startTag=e.startTag.replace(/\n((>|\s)*)\n$/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})),e.endTag&&(e.endTag=e.endTag.replace(/^\n((>|\s)*)\n/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"}))};/^(?![ ]{0,3}>)/m.test(e.selection)?(this.wrap(e,p.lineLength-2),e.selection=e.selection.replace(/^/gm,"> "),c(!0),e.skipLines()):(e.selection=e.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(e),c(!1),!/^(\n|^)[ ]{0,3}>/.test(e.selection)&&e.startTag&&(e.startTag=e.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(e.selection)&&e.endTag&&(e.endTag=e.endTag.replace(/^\n{0,2}/,"\n\n"))),e.selection=this.hooks.postBlockquoteCreation(e.selection),/\n/.test(e.selection)||(e.selection=e.selection.replace(/^(> *)/,function(t,n){return e.startTag+=n,""}))},y.doCode=function(e){var t=/\S[ ]*$/.test(e.before),n=/^[ ]*\S/.test(e.after);if(!n&&!t||/\n/.test(e.selection)){e.before=e.before.replace(/[ ]{4}$/,function(t){return e.selection=t+e.selection,""});var r=1,i=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&(r=0),/^\n(\t|[ ]{4,})/.test(e.after)&&(i=0),e.skipLines(r,i),e.selection?/^[ ]{0,3}\S/m.test(e.selection)?/\n/.test(e.selection)?e.selection=e.selection.replace(/^/gm,"    "):e.before+="    ":e.selection=e.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\t)/gm,""):(e.startTag="    ",e.selection=this.getString("codeexample"))}else e.trimWhitespace(),e.findTags(/`/,/`/),e.startTag||e.endTag?e.endTag&&!e.startTag?(e.before+=e.endTag,e.endTag=""):e.startTag=e.endTag="":(e.startTag=e.endTag="`",e.selection||(e.selection=this.getString("codeexample")))},y.doList=function(e,t,n){var r=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,i=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,o="-",a=1,s=function(){var e;return n?(e=" "+a+". ",a++):e=" "+o+" ",e},c=function(e){return void 0===n&&(n=/^\s*\d/.test(e)),e=e.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return s()})};if(e.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),!e.before||/\n$/.test(e.before)||/^\n/.test(e.startTag)||(e.before+=e.startTag,e.startTag=""),e.startTag){var u=/\d+[.]/.test(e.startTag);if(e.startTag="",e.selection=e.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(e),e.skipLines(),u&&(e.after=e.after.replace(i,c)),n==u)return}var l=1;e.before=e.before.replace(r,function(e){return/^\s*([*+-])/.test(e)&&(o=d.$1),l=/[^\n]\n\n[^\n]/.test(e)?1:0,c(e)}),e.selection||(e.selection=this.getString("litem"));var f=s(),h=1;e.after=e.after.replace(i,function(e){return h=/[^\n]\n\n[^\n]/.test(e)?1:0,c(e)}),e.trimWhitespace(!0),e.skipLines(l,h,!0),e.startTag=f;var g=f.replace(/./g," ");this.wrap(e,p.lineLength-g.length),e.selection=e.selection.replace(/\n/g,"\n"+g)},y.doHeading=function(e){if(e.selection=e.selection.replace(/\s+/g," "),e.selection=e.selection.replace(/(^\s+|\s+$)/g,""),!e.selection)return e.startTag="## ",e.selection=this.getString("headingexample"),e.endTag=" ##",void 0;var t=0;e.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(e.startTag)&&(t=d.lastMatch.length),e.startTag=e.endTag="",e.findTags(null,/\s?(-+|=+)/),/=+/.test(e.endTag)&&(t=1),/-+/.test(e.endTag)&&(t=2),e.startTag=e.endTag="",e.skipLines(1,1);var n=0==t?2:t-1;if(n>0){var r=n>=2?"-":"=",i=e.selection.length;for(i>p.lineLength&&(i=p.lineLength),e.endTag="\n";i--;)e.endTag+=r}},y.doHorizontalRule=function(e){e.startTag="----------\n",e.selection="",e.skipLines(2,1,!0)}}(),function(){function e(){for(var e=0;e<w.length;e++)w[e].refreshPreview()}function t(e){var t='<p>http://example.com/ "optional title"</p>',n="Insert Hyperlink";return{"bold":"Strong <strong> Ctrl+B","boldexample":"strong text","italic":"Emphasis <em> Ctrl+I","italicexample":"emphasized text","link":"Hyperlink <a> Ctrl+L","linkdescription":"enter link description here","linkdialog":"<p><b>"+n+"</b></p>"+t,"linktabtitle":n,"quote":"Blockquote <blockquote> Ctrl+Q","quoteexample":"Blockquote","code":e?"Preformatted text <pre><code> Ctrl-K":"Code Sample <pre><code> Ctrl+K","codeexample":e?"enter preformatted text here":"enter code here","image":"Image <img> Ctrl+G","imagedescription":"enter image description here","imagedialog":'<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg "optional title"</p>',"olist":"Numbered List <ol> Ctrl+O","ulist":"Bulleted List <ul> Ctrl+U","litem":"List item","heading":"Heading <h1>/<h2> Ctrl+H","headingexample":"Heading","hr":"Horizontal Rule <hr> Ctrl+R","undo":"Undo - Ctrl+Z","redo":"Redo - Ctrl+Y","redomac":"Redo - Ctrl+Shift+Z","help":"Markdown Editing Help","ok":"OK","cancel":"Cancel"}}function n(e){var t=e.match(/^\s*>\s*!/gm);if(t&&t.length==e.split("\n").length){var n=!1;e=e.replace(/(.*) (\w)/,function(e,t,r){return n=!0,t+"\n> "+r}),n||(e=e.replace(/^(\s*>\s*)!/m,"$1&#33;"))}return e}function r(e){var t=/\<blockquote\>[\n\s]*?\<p\>[\n\s]*?(![\s\S]*?)\<\/p\>[\n\s]*?\<\/blockquote\>/g,n=/^\s*?[^\s!]/m,r=/^\s*?!/gm;return e=e.replace(t,function(e,t){return n.test(t)?e:(e=e.replace(t,t.replace(r,"").replace(/[$]/g,"$$$$")),e=e.replace("<blockquote>",'<blockquote class="spoiler">'))})}function i(e){for(var t,n=[],r=/<(a|code)[^>]*>/gi;null!=(t=r.exec(e));){n.push(t.index);var i=new RegExp("</"+t[1]+">","ig");i.lastIndex=r.lastIndex;var o=i.exec(e);if(null==o)break;n.push(i.lastIndex),r.lastIndex=i.lastIndex}return n}function o(e){if(!window.tagRendererRaw)return e;var t,n,r=StackExchange.settings.tags.allowNonAsciiTags?/\[(meta-)?tag:([a-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF#+.-]+)\]/gi:/\[(meta-)?tag:([a-z0-9#+.-]+)\]/gi;return e=e.replace(r,function(r,o,a,s){if(!y&&o)return r;t||(t=i(e),n=t.length);for(var c=!1,u=0;n>u&&!(t[u]>s);u++)c=!c;if(c)return r;var l=null;StackExchange.options.site.parentUrl&&!o&&(l=StackExchange.options.site.parentUrl),StackExchange.options.site.routePrefix&&!l&&(l=StackExchange.options.site.routePrefix);var f=StackExchange.helpers.sanitizeAndSplitTags(a);return 1!==f.length?r:tagRendererRaw(f[0],l)})}function a(e){var t,n,r;"undefined"==typeof E&&(E=StackExchange.settings.site.styleCode),E&&(t=l(e),n=l(t+e),e=h(e,t,n));var r=s(e);return E&&(r=p(r,t,n)),r}function s(e){return e.replace(/<[^>]*>?/gi,c)}function c(e){if(e.match(C)||e.match(_)||e.match(T)||StackExchange.settings.markdown.linkEmails===!0&&e.match(j))return e;var t=!1,n=e.replace(/^(<a href="|<img src=")([^"]*)/i,function(e,n,r){return n+r.replace(/[^-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)*[\]$]/g,function(e){return t=!0,"'"==e?"%27":encodeURIComponent(e)})});return t&&(n.match(_)||n.match(T))?n:""}function u(e){if(""==e)return"";var t=/<\/?\w+[^>]*(\s|$|>)/g,n=e.toLowerCase().match(t),r=(n||[]).length;if(0==r)return e;for(var i,o,a,s="<p><img><br><li><hr>",c=[],u=[],l=!1,f=0;r>f;f++)if(i=n[f].replace(/<\/?(\w+).*/,"$1"),!(c[f]||s.search("<"+i+">")>-1)){if(o=n[f],a=-1,!/^<\//.test(o))for(var d=f+1;r>d;d++)if(!c[d]&&n[d]=="</"+i+">"){a=d;break}-1==a?l=u[f]=!0:c[a]=!0}if(!l)return e;var f=0;return e=e.replace(t,function(e){var t=u[f]?"":e;return f++,t})}function l(e){var t=(e.match(/~/g)||[]).length;return new Array(t+2).join("~")}function f(e){var t=I.length;t>0&&0===e.indexOf(I[t-1])?I[t-1]=e:I.push(e),P.trigger()}function d(e){if(/^lang-/.test(e))return e;var t="c_"+e,n=M[t];return n?n:A[t]?null:(A[t]=!0,f(e),null)}function h(e,t,n){return e=e.replace(O,function(e,n,r){return t+n+t+r}),e.replace(D,function(e,t){return n+t+n})}function p(e,t,n){var r=new RegExp(t+"([a-z0-9#+.-]+)"+t+"(\\s*?<pre)","gi");e=e.replace(r,function(e,t,n){var r=d(t);return r?n+" class='"+r+" prettyprint-override'":n});var i,o=new RegExp("("+n+"([a-z0-9#+.-]+)"+n+")|(<pre><code>)","gi");return e.replace(o,function(e,t,n){if(t)return i=n,"";if(!i)return e;var r=d(i);return r?"<pre class='"+r+" prettyprint-override'><code>":e})}function g(e){function t(e){e.is(":animated")||e.animate({"marginTop":-15},400).animate({"marginTop":0},400).animate({"marginTop":-8},300).animate({"marginTop":0},300).animate({"marginTop":-4},200).animate({"marginTop":0},200).animate({"marginTop":-2},100).animate({"marginTop":0},100).animate({"marginTop":-1},50).animate({"marginTop":0},50)}function n(e){if(s)return e(),void 0;if(!u){u=!0;var n=d.offset();c=$("#wmd-help-button"+l);{var r=c.offset().left+c.outerWidth(),i=n.left,o=d.outerWidth()+i;Math.max(r,o)}c.addClass("active-help"),s=$('<div id="mdhelp'+l+'" class="mdhelp"><ul id="mdhelp-tabs'+l+'" class="mdhelp-tabs"><li /></ul></div>').find("li").addSpinner().end().hide().insertAfter(c.parent().parent()).slideDown("fast"),$.get("/posts/markdown-help",{"postfix":l}).done(function(n){s.remove(),s=$(n).insertAfter(c.parent().parent()),$("#mdhelp-tabs"+l).delegate("li:not(:last-child)","click",function(){var e=$(this).hasClass("selected");if(s.find(".mdhelp-tab").slideUp("fast"),$("#mdhelp-tabs"+l+" li").removeClass("selected"),!e){$("#"+$(this).attr("data-tab")).slideDown("fast"),$(this).addClass("selected");var n=$(this).attr("data-buttons");if(n)for(var r=n.split(","),i=0;i<r.length;i++)t($("#wmd-"+r[i]+"-button"+l))}}),u=!1,e()})}}function r(){h=!0,n(function(){c.addClass("active-help"),s.slideDown("fast")})}function i(){h||r()}function o(e){s.slideUp("fast"),c.removeClass("active-help"),e||StackExchange.options.user.isAnonymous||$.post("/users/toggle-flag/DismissMarkdownEditorHelp/true",{"fkey":StackExchange.options.user.fkey,"userId":f})}function a(){s&&s.is(":visible")?o():r()}var s,c,u=!1;e=e||{};var l=e.postfix||"",f=e.userId||0,d=$("#wmd-input"+l),h=!1;this.toggle=a,this.showOnce=i,this.hide=function(){s&&s.is(":visible")&&o(!0)}}function m(e){function t(e,t){var r=f[e+"|"+t];return r?r:(n(e,t),null)}function n(e,t){if(!d[e+"|"+t]&&!r(e)){d[e+"|"+t]=!0;var n=h[e];n||(n=h[e]=[]),n.push(t),m.trigger()}}function r(e){return e===s?!1:v["s_"+e]?!0:l&&e===l?!1:u&&e===u?!1:StackExchange.options.site.isMetaSite&&e===StackExchange.options.networkMetaHostname?!1:s===StackExchange.options.networkMetaHostname?!1:!0}function i(e){var t=e.toLowerCase().replace(/\./g,"$").replace(/-/g,"_").replace(/[^_$a-z]/,"");return window.apiCallbacks[t]||(window.apiCallbacks[t]=function(t){b(t,e)}),"apiCallbacks."+t}function o(e,t){if(e===s)return!0;var n=y[e];return n||(n=y[e]={"count":0,"ids":{}}),n.ids[t]?!0:n.count>=w?!1:(n.count++,n.ids[t]=!0,!0)}var a=/<a href="((\S+)\/q(?:uestions)?\/(\d+)(?:|\/\S*?))">\1<\/a>/g,s=window.location.hostname.toLowerCase(),c=StackExchange.options.site,u=c.parentUrl&&StackExchange.helpers.parseUrl(c.parentUrl).hostname,l=c.childUrl&&StackExchange.helpers.parseUrl(c.childUrl).hostname,f={},d={},h={},p="6AU78DZ)GcdjNjAszYmTLQ((",g="!6G7RPxWUNTleV",m=StackExchange.helpers.DelayedReaction(function(){var e=!1;for(var t in h)if(h.hasOwnProperty(t)){var n,r=i(t);h[t].length>30?n=h[t].splice(0,30).join(";"):(n=h[t].join(";"),delete h[t]),e=!0,$.ajax({"url":"https://api.stackexchange.com/2.0/questions/"+n+"?pagesize=30&key="+p+"&filter="+g+"&site="+t,"crossDomain":!0,"jsonpCallback":r,"dataType":"jsonp"});break}e&&m.trigger()},1e3,{"sliding":!0}),v={};window.apiCallbacks={};var b=function(t,n){if(t){if(t.error_message)return/^No site found/.test(t.error_message)&&(v["s_"+n]=!0),void 0;if(t.items){for(var r=t.items,i=r.length,o=0;i>o;o++){var a=r[o];f[n+"|"+a.question_id]=a.title}e&&e()}}},y={},w=StackExchange.options.site.isMetaSite?40:10;return function(e){return y={},e.replace(a,function(e,n,r,i){if(r=r.toLowerCase().replace(/^https?:\/\//,""),/[^a-z0-9.]/.test(r))return e;if(!o(r,i))return e;var a=t(r,i);return a?'<a href="'+n+'">'+a+"</a>":e})}}function v(){return function(e){return e.replace(/<(a\shref|img\ssrc)="(http:)?(\/\/([^""\/]+?\.)?imgur.com\/[^""]+?)"/gi,'<$1="https:$3"')}}function b(e,t,n,r){function i(e){h=null,$("#wmd-button-bar"+n+" .wmd-button__active").removeClass("wmd-button__active"),e?$(".js-wmd-inline-dialog-"+n).remove():$(".js-wmd-inline-dialog-"+n).slideUp(100,function(){$(this).remove()}),$("#wmd-input"+n).prop("disabled",!1).focus(),$("#wmd-button-bar"+n).removeClass("has-active-button"),f&&(f(),f=null)}function o(e){$("#wmd-image-button"+n+".wmd-button__active").length?h(e):(d=e,setTimeout(function(){d=null},500),$("#wmd-image-button"+n).click())}function a(e){e=e.originalEvent||e;var t=e.dataTransfer.items,n=!1;if(t)for(var r=0;r<t.length;r++){if(/^image\//.test(t[r].type))return"yes";"file"===t[r].kind&&(n=!0)}if(n)return"no";var i=e.dataTransfer.types;if(i)for(var r=0;r<i.length;r++)if("Files"===i[r])return"maybe";return"no"}function s(e){var t=c(e);return t?t.getAsFile?t.getAsFile():t:null}function c(e){if(!e)return null;e=e.originalEvent||e;var t;try{switch(e.type){case"change":t=e.target.files;break;case"paste":t=e.clipboardData.items;break;case"drop":case"dragover":case"dragenter":t=e.dataTransfer.items||e.dataTransfer.files}}catch(n){}if(!t||!t.length)return null;for(var r,i=0;i<t.length;i++)if(/^image\//.test(t[i].type)){r=t[i];break}return r}function u(e){var t=$("#wmd-button-bar"+n);i(!0),r.hide(),e.addClass("wmd-button__active"),t.addClass("has-active-button")}function l(e){e.find(".js-cancel-button").click(function(){return i(),!1}),e.keydown(function(e){return 27===e.which?(i(),!1):void 0})}var f;e.hooks.set("skipModalBackground",function(){return!0});var d,h,p,g=$("#post-editor"+n);return $(document).on("paste",function(e){if($(e.target).add(":focus").closest(g).length){var t=s(e);if(t)return o(t),!1;if($("#wmd-image-button"+n+".wmd-button__active").length&&!$(e.target).is("input[type=text], textarea")){var r=e.originalEvent.clipboardData.getData("text/plain");if(r)return p(r),!1}}}),$("#wmd-input"+n).on("dragenter dragover",function(e){var t="no"!==a(e);return e.originalEvent.dataTransfer.dropEffect=t?"copy":"none",!1}).on("drop",function(e){var t=s(e);return t&&o(t),!1}),e.hooks.set("interceptButtonClick",function(e,t){return"image"!==t&&"link"!==t?!1:$(e).hasClass("wmd-button__active")?(i(),!0):!1}),e.hooks.set("insertLinkDialog",function(e){var t=$("#wmd-link-button"+n);u(t);var r=$("#wmd-button-bar"+n),o=$("<div class='wmd-inline-dialog js-wmd-inline-dialog-"+n+"'><p><b>Insert Hyperlink</p></b><div class='grid'><input class='s-input' /><button class='s-btn s-btn__outlined ws-nowrap ml16 js-insert-link-button'/><button class=\"s-btn js-cancel-button\">Cancel</button></div></div>");return o.find(".js-insert-link-button").text("Add link").click(function(){var t=$(this).parent().find("input").val();return t=t.replace(/^https:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(t)||(t="http://"+t),f=null,i(),e(t),!1}).end().insertAfter(r).hide().slideDown(100).find("input").val("https://").keydown(function(e){return 13===e.which?(o.find(".js-insert-link-button").click(),!1):void 0}),$("#wmd-input"+n).prop("disabled",!0),setTimeout(function(){var e=o.find("input");e.caret(0,8),e.focus()},0),f=function(){e(null)},l(o),!0}),e.hooks.set("insertImageDialog",function(e){function r(){y&&(URL.revokeObjectURL(y),y=null)}var o=$("#wmd-image-button"+n);u(o);var c=$("#wmd-button-bar"+n),g=$("<div class='wmd-inline-dialog p0 js-wmd-inline-dialog-"+n+'\'><input class="ps-absolute o0" type="file" name="file" accept="image/*" id="image-upload-file-input'+n+"\" /><div class='grid fd-column js-stacks-validation'>"+(t.imageUploader.showLowRepImageUploadWarning?"<div class='s-notice s-notice__warning m16 mb0'>Images are useful in a post, but <b>make sure the post is still clear without them</b>.  If you post images of code or error messages, copy and paste or type the actual code or message into the post directly.</div>":"")+"<div class='grid--cell grid ps-relative p16 hmn1 js-drop-target'><div class='grid--cell grid ai-center fl-grow1 js-pseudo-input'><img class='grid--cell hmx1 wmx2 mr32 d-none js-image-upload-preview' /><div class='grid--cell grid fl-grow1 ai-baseline sm:fd-column sm:ai-stretch d-none js-url-input-container'><label class='s-label mr8 sm:mr0 sm:mb4' for='image-upload-url-input"+n+"'>"+(t.imageUploader.allowUrls?"Paste image or link:":"Paste image:")+"</label><div class='fl1 ps-relative'><input type='text' class='s-input' id='image-upload-url-input"+n+"' /></div><button class='s-btn sm:as-start js-cancel-url'>Cancel</button></div><div class='grid-cell grid gs8 gsy fd-column js-cta-container'><div class='grid--cell fs-body2'>"+(t.imageUploader.allowUrls?function(e){return e.browseStart+"Browse"+e.browseEnd+", drag &amp; drop, or "+e.pasteStart+"paste"+e.pasteEnd+" an image or link"}({"browseStart":"<label class='s-link js-image-upload-label' for='image-upload-file-input"+n+"'>","browseEnd":"</label>","pasteStart":"<button class='s-btn s-btn__link js-show-url-input'>","pasteEnd":"</button>"}):function(e){return e.browseStart+"Browse"+e.browseEnd+", drag &amp; drop, or "+e.pasteStart+"paste"+e.pasteEnd+" an image"}({"browseStart":"<label class='s-link js-image-upload-label' for='image-upload-file-input"+n+"'>","browseEnd":"</label>","pasteStart":"<button class='s-btn s-btn__link js-show-url-input'>","pasteEnd":"</button>"}))+"</div><div class='fs-caption fc-black-300'>(max 2MB)</div></div></div></div><p class='grid--cell px16 s-input-message d-none js-stacks-validation-message' /><div class='grid--cell grid ai-center p16 bt bc-black-4'><button class=\"s-btn s-btn__primary ws-nowrap js-add-picture\" disabled>Add picture</button><button class=\"s-btn ws-nowrap js-cancel-button\">Cancel</button><div class=\"ml64 grid fd-column fs-caption fc-black-300 s-anchors s-anchors__muted\">"+(t.imageUploader.brandingHtml?"<span>"+t.imageUploader.brandingHtml+"</span>":"")+(t.imageUploader.contentPolicyHtml?"<span>"+t.imageUploader.contentPolicyHtml+"</span>":"")+"</div></div></div></div>");g.insertAfter(c).hide().slideDown(100,function(){var e=g.find(".js-add-picture");e.prop("disabled")?setTimeout(function(){$("#image-upload-file-input"+n).focus()},100):e.focus()}),g.find(".icon-imgur-white").removeClass("icon-imgur-white").addClass("icon-imgur-black ml4 mr16"),g.find(".js-url-input-container input").keydown(function(e){return 13===e.which?(g.find(".js-add-picture").click(),!1):void 0});var m=StackExchange.stacksValidation.handlerFor(g.find(".js-pseudo-input")),v=!1;$("#wmd-input"+n).prop("disabled",!0);var b,y,w,x="file";p=function(e){(!e||t.imageUploader.allowUrls)&&(e&&!/^https?:\/\//i.test(e)&&(e="https://"+e),m.clear(),m=StackExchange.stacksValidation.handlerFor($("#image-upload-url-input"+n)),r(),x="url",w=e,g.find(".js-image-upload-preview, .js-cta-container").addClass("d-none"),g.find(".js-url-input-container").removeClass("d-none").find("input").val(e).trigger("input").focus())},h=function(e){if(!v){if(m.clear(),m=StackExchange.stacksValidation.handlerFor(g.find(".js-pseudo-input")),r(),x="file",g.find(".js-url-input-container").addClass("d-none"),g.find(".js-cta-container").removeClass("d-none"),e){y=URL.createObjectURL(e),g.find(".js-image-upload-preview").attr("src",y).removeClass("d-none");var t=e.size>=2097152;t&&m.add("error","Your image is too large to upload (over 2 MB)."),g.find(".js-add-picture").prop("disabled",t).focus()}else g.find(".js-image-upload-preview").removeAttr("src").addClass("d-none"),g.find(".js-add-picture").prop("disabled",!0);b=e}};var k=!1;f=function(){k=!0,r(),e(null)},d&&(h(d),d=null);var S=$("#image-upload-file-input"+n).on("change",function(e){h(s(e))});return $("#image-upload-url-input"+n).on("input",function(){var e;t.imageUploader.allowUrls?e=!$(this).val():(m.clear(),$(this).val()&&m.add("error",function(e){return"Uploading images via web links is not supported on this site. Paste an image from the clipboard or "+e.browseStart+"browse"+e.browseEnd+" files on your device."}({"browseStart":"<label class='s-link fc-red-800 td-underline' for='image-upload-file-input"+n+"'>","browseEnd":"</label>"}))),g.find(".js-add-picture").prop("disabled",e)}),g.find(".js-show-url-input").click(function(){return p(""),!1}),g.find(".js-cancel-url").click(function(){return h(null),!1}),g.find(".js-drop-target").on("drop",function(e){return v||h(s(e)),!1}).on("dragenter dragover",function(e){var t="no"!==a(e);return e.originalEvent.dataTransfer.dropEffect=t&&!v?"copy":"none",!1}),g.find(".js-add-picture").on("click",function(t){t.preventDefault(),v=!0,m.clear();var o=S.add("#image-upload-url-input"+n).prop("disabled",!0),a=new FormData;"file"===x?a.append("file",b):(p($("#image-upload-url-input"+n).val()),a.append("upload-url",w));var s=$(this).addClass("is-loading").prop("disabled",!0);a.append("fkey",StackExchange.options.user.fkey),$.ajax({"url":"/upload/image?method=json&https=true","data":a,"cache":!1,"contentType":!1,"processData":!1,"type":"POST"}).done(function(t){if(!k)if(t.Success){var n=t.UploadedImage;f=null,r(),i(),e(n)}else t.ErrorMessage?m.add("error",$("<span/>").text(t.ErrorMessage).html()):m.add("error","An error occured when uploading the image.")}).fail(function(e,t,n){m.add("error",function(e){return"An error occured when uploading the image: "+e.message}({"message":n}))}).always(function(){s.removeClass("is-loading").prop("disabled",!1),o.prop("disabled",!1),v=!1})}),l(g),!0}),{"closeInlineDialog":i}}if(!StackExchange.MarkdownEditor){var y,w=[],x=m(e),k=v(),S=$.Callbacks();StackExchange.MarkdownEditor=function(e){var i=e.postfix||"";y=StackExchange.options.site.isMetaSite;var s=new Markdown.Converter({"nonAsciiLetters":!0,"asteriskIntraWordEmphasis":StackExchange.settings.markdown.asteriskIntraWordEmphasis,"autoNewlines":StackExchange.settings.markdown.autoNewlines,"linkEmails":StackExchange.settings.markdown.linkEmails,"codeFences":!StackExchange.settings.markdown.disableCodeFences});e.mutateConverter&&(s=e.mutateConverter(s));var c=e.sanitizeAndHighlight||a,l=s.hooks;l.addNoop("preSafe"),e.disableAutoQuestionLinks||l.chain("postConversion",x),l.chain("postConversion",function(e){return l.preSafe(e)}),l.chain("postConversion",c),l.chain("postConversion",u),l.chain("postConversion",r),l.chain("postConversion",o),window.modSuspendTokens&&l.chain("postConversion",window.modSuspendTokens);var f,d=new g({"postfix":i,"userId":e.userId});!e.imageUploader||"showLowRepImageUploadWarning"in e.imageUploader||(e.imageUploader.showLowRepImageUploadWarning=e.showLowRepImageUploadWarning);var h={"helpButton":{"handler":function(){f&&f(),d.toggle()}},"strings":t(e.noCode),"wrapImageInLink":!e.disableImageLinkWrapping,"convertImagesToLinks":e.convertImagesToLinks,"imageUploader":e.imageUploader},p=new Markdown.Editor(s,i,h);p.hooks.chain("postBlockquoteCreation",n),StackExchange.settings.site.allowImageUploads&&!e.noModals&&(e.showLowRepImageUploadWarning&&StackExchange.imageUploader.enableLowRepWarning(),p.hooks.set("insertImageDialog",StackExchange.imageUploader.uploadImageDialog)),e.noModals&&(f=b(p,h,i,d).closeInlineDialog),StackExchange.settings.site.enableImgurHttps&&l.chain("postConversion",k),S.fire(p,e.postfix);var m=$("#wmd-preview"+i);return p.hooks.chain("onPreviewRefresh",function(){m.trigger("wmdrefresh")}),w.push(p),p.run(),e.immediatelyShowMarkdownHelp?d.showOnce(e):e.autoShowMarkdownHelp&&$("#wmd-input"+i).one("focus",function(){d.showOnce(e)}),p.disableSubmission=function(){$("#submit-button"+i).attr("disabled","disabled"),StackExchange.navPrevention.stop()},p},StackExchange.MarkdownEditor.creationCallbacks=S,StackExchange.MarkdownEditor.refreshAllPreviews=e;var E;StackExchange.MarkdownEditor.sanitizeHtml=s;var C=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol(?: start="\d+")?|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,_=/^(<a\s(class="s-link"\s)?href="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)*[\]$]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,T=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)*[\]$]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i,j=/^(<a\shref="mailto:[-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+">$)/i;StackExchange.MarkdownEditor.balanceTags=u;var M={},A={},I=[],P=StackExchange.helpers.DelayedReaction(function(){0!=I.length&&($.ajax("/api/tags/"+encodeURIComponent(I.join(";"))+"/syntax-highlight",{"cache":!0}).done(function(e){var t=!1;for(var n in e)e.hasOwnProperty(n)&&(M["c_"+n]=e[n],t=!0);t&&(StackExchange.MarkdownEditor.refreshAllPreviews(),styleCode())}),I=[])},2e3,{"sliding":!0}),O=/<!-- language: ([a-z0-9#+\-.]+) -->(\s*?<pre>\s*?<code>)/gi,D=/<!-- language-all: ([a-z0-9#+\-.]+) -->/gi;if(StackExchange.settings.site.forceHttpsImages&&StackExchange.MarkdownEditor.creationCallbacks.add(function(e,t){t=t||"";var n=e.getConverter().hooks,r=$("#wmd-input"+t),i=$("#wmd-preview"+t);n.chain("postConversion",function(e){return e=e.replace(new RegExp(/<a[^>]*?>/.source+/(?!.*?<a)/.source+/(?=.*?<img\ssrc="(?:http:)?\/\/)/.source+/(.*?)<\/a>/.source,"gi"),"$1"),e=e.replace(/<img\ssrc="((?:http:)?\/\/[^"]*)"[^>]*?>/gi,function(e,t){return'<span class="message error centered-block text-centered" >All image URLs must start with <strong>https://</strong><br /><a href="javascript: void(0)" data-image-url="'+t+'" class="js-wmd-upload-image">Upload to imgur</a> or specify an HTTPS URL</span>'})}),i.on("click",".js-wmd-upload-image",function(t){var n=$(t.target).data("image-url");return StackExchange.imageUploader.createImageUploadBackground(),StackExchange.imageUploader.uploadImageDialog(function(t){t&&e.textOperation(function(){var e=r.val();e=e.replace(n,t),r.val(e)}),StackExchange.imageUploader.removeImageUploadBackground(),r.focus()},{"imageUrl":n}),t.preventDefault(),!1})}),"undefined"!=typeof MathJax){var L=MathJax.Hub.config,R=!1,q=$.Callbacks(),N=function(e,t){StackExchange.mathjaxEditing.prepareWmdForMathJax(e,t,L.tex2jax.inlineMath)};StackExchange.MarkdownEditor.creationCallbacks.add(function(e,t){R?N(e,t):q.add(function(){N(e,t),e.refreshPreview()})}),StackExchange.using(L.SEEditor,function(){R=!0,q.fire(),q.empty()},"mathjax-editing")}}}(),StackExchange.editor=function(){var e=function(e){e=e||{};var t,n,r=e.postfix||"",i=void 0===e.resize?!0:e.resize,o=e.heartbeatType,a=e.bindNavPrevention,s=$("#post-form"+r),c=$("#wmd-input"+r);n=$("#title, #edit-comment, #m-address, .edit-comment"),t=n.add(".tag-editor input"),s.submit(function(){var e=!0;return e&&(StackExchange.helpers.disableSubmitButton(s),StackExchange.navPrevention.stop()),e}),i&&($(".original-question").not(".processed").TextAreaResizer(),c.not(".processed").TextAreaResizer()),c.typeWatch({"highlight":!1,"wait":5e3,"captureLength":5,"callback":styleCode});var u=new StackExchange.MarkdownEditor(e);if(o){var l=e.discardSelector?$(e.discardSelector):null;StackExchange.cardiologist.addHeart(o,c,u,l,e.postId,e.autoActivateHeartbeat)}if(u.hooks.chain("imageConvertedToLink",function(){var t=c.parent(),n="You're not allowed to embed images in your posts yet, so we've included a link instead.";e.reputationToPostImages&&(n+="<br/><br/>"+function(e){return"As soon as you earn "+e.rep+" reputation on the site, you'll be able to embed images."}({"rep":e.reputationToPostImages})),StackExchange.helpers.showInfoMessage(t,n,{"position":{"at":"right top","my":"left bottom"},"cssClass":"convert-image-to-link"})
}),"ask"==o||"answer"==o){var f=c.add(t),d=function(){return StackExchange.helpers.loadTicks(s),f.unbind("keydown",d),!0};f.bind("keydown",d)}if(a){var h="edit"==o||"ask"==o?c.add("#title").add("#tagnames"):c;StackExchange.navPrevention.init(h)}if(s.find(".wmd-preview").click(function(e){if("show-hide"!==e.target.className&&!e.target.localName.startsWith("input")){if(window.getSelection){var t=window.getSelection();if(t.anchorNode!==t.focusNode||t.anchorOffset!==t.focusOffset)return}2!=e.which&&$(this).siblings().find("textarea").focus()}}),0==$("#ask-page-has-errors").length&&$("#title").is("input")&&0===s.find(":focus").length,e.onCreated&&e.onCreated(u),e.discardSelector&&("ask"==o||"answer"==o||"moderatormessage"==o)){var p=$(e.discardSelector);p.click(function(t){if(t.preventDefault(),confirm("Are you sure you want to discard your draft?")){$("#title").val("").blur(),$("#question-suggestions").empty(),$("#wmd-input-42").val(""),$("#wmd-preview-42").html(""),$("#answer-from-ask").is(":visible")&&$("#answer-from-ask").is(":checked")&&$("#answer-from-ask").click();var n=p.closest(".post-form").find("#tagnames");return n.length>0&&n[0].func_clear&&(n[0].func_clear(),n.blur()),c.val("").blur(),u.refreshPreview(),$.post("/post/discard-draft",{"fkey":StackExchange.options.user.fkey,"postType":o},function(){$("#draft-saved").hide(),$("#draft-discarded").show();var e=null;e=function(){$("#draft-discarded").hide(),$("#title").unbind("keypress",e),c.unbind("keypress",e)},$("#title").bind("keypress",e),c.bind("keypress",e)}),p.hide(),e.onDraftDiscarded&&e.onDraftDiscarded(),!1}})}$(".js-post-editor input[type=checkbox][name=communitymode]").off("click").one("click",function(){return confirm(function(e){return"Are you sure you want to make this post Community Wiki?"+e.blankLine+"Doing so will remove explicit ownership and you will no longer earn reputation for upvotes on it. Once saved, this option cannot be unchecked without moderator assistance."}({"blankLine":"\n\n"}))})},t=function(t){var n=(t||{}).postfix||"",r=0!=$("#wmd-preview"+n).length&&("-42"!==n||0===$("#answer-from-ask").length)&&0===$("#show-editor-button"+n).length;r?(e(t),StackExchange.editor.finallyInit||(StackExchange.editor.finallyInit=function(){})):StackExchange.editor.finallyInit=function(){e(t)}};return{"init":e,"initIfShown":t}}(),StackExchange.cardiologist=function(){function e(e){var n="number"==typeof e?e:1e3*(m+v);d&&(n=Math.max(n,6e3-((new Date).getTime()-d))),h&&clearTimeout(h),h=setTimeout(t,n)}function t(){if(h=null,g.length||n(),!g.length)return e(),void 0;var t=g.shift();t.checkActive()?t.beat():e()}function n(){var e;g=[],l&&!l.isDisabled&&l.beatCount<30&&g.push(l);for(var t=0;t<p.length;t++)e=p[t],e!=l&&!e.isDisabled&&e.beatCount<30&&g.push(e);m=Math.max(15,Math.min(45,60/(g.length||1)))}function r(){}function i(e){var t=[];$.get("/questions/"+e,function(n){var r=$(n);if(r.find("div.answer").each(function(){var e=this.id.substring("answer-".length);0==$("#answer-"+e).length&&t.push(this.id)}),t.length>0){var i="#"+t.join(",#"),o=r.find(i),a=$("div.answer:last");0==a.length&&(a=$("#answers-header")),o.hide(),a.after(o),o.fadeIn("slow");var s=r.find("#answers-header .answers-subheader h2"),c=$("#answers-header .answers-subheader h2");s.length&&c.length&&c.replaceWith(s),StackExchange.vote.init(e),StackExchange.comments.init({"post":o})}StackExchange.notify.close(y),b=!1},"html")}function o(e,t,n,i,o,a){var s,c=new r;switch(c.type=e,c.jTextarea=t,c.discardDraftLink=i,e){case"ask":s=0;break;case"answer":s=$("#post-id").val()||location.href.match(/\/questions\/(\d+)/i)[1];break;case"edit":s=o||$("#post-id").val()||t.closest(".question, .answer").find(".vote input").val();var u=t.closest(".inline-post"),l=null;u.length>0&&(l=u[0].action.split("/").pop()),l||(l=$("#client-revision-guid").val()),c.revisionGuid=l;break;case"moderatormessage":s=+$("#moderator-message-to-user").attr("data-userid")}c.postId=s,c.editor=n,t.keypress(function(){c.activate()}),a&&c.activate()}function a(e,t){return l&&l.checkActive()?(l.beat(t).done(e),void 0):(e(),void 0)}function s(){e(1)}function c(){b=!0}function u(){if(null==p)return!1;for(var e=0;e<p.length;e++)if(1==p[e].checkActive())return!0;return!1}var l,f,d,h,p=[],g=[],m=45,v=0,b=!1,y=-2,w={"ask":function(e){if(e.relatedQuestions){var t=$(".js-similar-questions");t.empty().append(e.relatedQuestions),$(".js-similar-questions-outer-div").removeClass("d-none"),$(".js-question-summary-scroll").one("scroll",function(){StackExchange.using("gps",function(){StackExchange.gps.track("similarquestions.body_scroll")})})}e.suggestedTags&&StackExchange.tagSuggestions&&StackExchange.tagSuggestions.suggest(e.suggestedTags)},"answer":function(e,t){if(e&&!b)if(e.disableEditor)StackExchange.notify.show(e.message,y),b=!0;else{var n=parseInt(e.message);if(n>0){var r=function(e){return 1==e.count?e.count+" new answer has been posted - "+e.startAnchor+"load new answers."+e.endAnchor:e.count+" new answers have been posted - "+e.startAnchor+"load new answers."+e.endAnchor}({"count":n,"startAnchor":'<a id="load-new-answers">',"endAnchor":"</a>"});StackExchange.notify.show(r,y),b=!0,$("#load-new-answers").click(function(){i(t.postId)})}}},"edit":function(e){if(e&&e.message){var t=StackExchange.notify.getMessageText(y);t!=$("<span />").html(e.message).text()&&(StackExchange.notify.close(y),StackExchange.notify.show(e.message,y))}},"moderatormessage":function(){}};r.prototype={"activate":function(){l=this,this.isActive||(this.isActive=!0,this.beatCount=0,p.push(this),1===p.length&&e())},"checkActive":function(){return!this.isActive||this.isDisabled?!1:this.jTextarea.closest("body").length?!0:(delete this.jTextarea,this.isDisabled=!0,!1)},"beat":function(e){var t=this,n={"type":"POST","url":"/posts/"+this.postId+"/editor-heartbeat/"+this.type,"dataType":"json","data":{}};if(e||(n.success=function(e){t.success(e)},n.error=function(){t.error()},n.complete=function(){t.complete()}),this.shouldSendDraft()){var r={"text":this.jTextarea.val()};"ask"===this.type&&(r.title=$("#title").val(),r.tagnames=$("#tagnames").val(),r.answertext=$("#wmd-input-42").val(),r.wizardsummary=$(".js-wz-summary-input").val(),r.wizardcontext=$(".js-wz-context-input").val(),r.wizardcode=$(".js-wz-code-input").val(),r.wizardresults=$(".js-wz-results-input").val()),f&&f.heart===this&&f.title===r.title&&f.tagnames===r.tagnames&&f.text===r.text&&f.answertext===r.answertext&&f.wizardsummary===r.wizardsummary&&f.wizardcontext===r.wizardcontext&&f.wizardcode===r.wizardcode&&f.wizardresults===r.wizardresults||(n.data=r,f={"heart":this,"title":r.title,"tagnames":r.tagnames,"text":r.text,"answertext":r.answertext,"wizardsummary":r.wizardsummary,"wizardcontext":r.wizardcontext,"wizardcode":r.wizardcode,"wizardresults":r.wizardresults})}if(e&&!("text"in n.data))return $.Deferred().resolve().promise();if(this.revisionGuid&&(n.data.clientRevisionGuid=this.revisionGuid),"answer"===this.type){var i=$("#answers-header .answers-subheader h2"),o=i.data("answercount");null==o&&(o=i.text().replace(/ answers?/i,"")||"0"),n.data.clientCount=o}return n.data.fkey=StackExchange.options.user.fkey,d=(new Date).getTime(),$.ajax(n).promise()},"shouldSendDraft":function(){return"edit"!==this.type&&l===this},"success":function(e){w[this.type](e,this),e.disableEditor&&(this.editor.disableSubmission(),this.isDisabled=!0),e.draftSaved&&x(this.jTextarea,this.discardDraftLink),this.beatCount++,v=0},"error":function(){$("#draft-saved").hide(),l===this&&g.unshift(this),v=(new Date).getTime()%100/10},"complete":function(){e()}};var x=function(e,t){var n=$("#draft-saved"),r=function(){n.text("draft saved").fadeIn("fast")};n.is(":visible")?n.fadeOut("fast",r):r(),t&&t.removeClass("dno").show();var i=function(t){(115!=t.which||!t.ctrlKey||t.shiftKey||t.altKey)&&(e.unbind("keypress",i),$("#draft-saved").fadeOut("fast"))};e.bind("keypress",i),$("#draft-discarded").hide()};return{"addHeart":o,"ensureDraftSaved":a,"beatASAP":s,"notifiedOfNewAnswer":c,"isHeartBeating":u}}(),StackExchange.navPrevention=function(){var e,t,n=function(){var n=!1;return e.each(function(e){n=n||$(this).val().replace(/\s+$/g,"")!==t[e].replace(/\s+$/g,"")}),n},r=function(t){window.onbeforeunload=t?function(){return e&&n()?t:void 0}:null},i=function(){r("You have started writing or editing a post.")};return{"init":function(n){e=n.one("keypress",i),t=[],n.each(function(){t.push($(this).val())})},"start":function(){e&&i()},"stop":function(){e&&(e.unbind("keypress",i),r(null),e=null)},"confirm":function(t){return e&&n()?confirm(t):!0}}}(),function(e){function t(t){return o=e(t.data.el),o.blur(),s=i(t).y,a=o.height()-s,o.css("opacity",.25),e(document).mousemove(n).mouseup(r),!1}function n(e){var t=i(e).y,n=a+t;return s>=t&&(n-=5),s=t,n=Math.max(c,n),o.height(n+"px"),c>n&&r(e),!1}function r(){e(document).unbind("mousemove",n).unbind("mouseup",r),o.css("opacity",1),o.focus(),o=null,a=null,s=0}function i(e){return{"x":e.clientX+document.documentElement.scrollLeft,"y":e.clientY+document.documentElement.scrollTop}}var o,a,s=0,c=32;e.fn.TextAreaResizer=function(){return this.each(function(){o=e(this).addClass("processed"),a=null,e(this).parent().append(e('<div class="grippie bbr-sm"></div>').bind("mousedown",{"el":this},t));var n=e("div.grippie",e(this).parent())[0];n.style.marginRight=n.offsetWidth-e(this)[0].offsetWidth+"px"})}}(jQuery),StackExchange.imageUploader=function(){var e=window.URL||window.webkitURL,t={},n=function(){var e,t,n,r,i=window.document,o=window.self;o.innerHeight&&o.scrollMaxY?(e=i.body.scrollWidth,t=o.innerHeight+o.scrollMaxY):i.body.scrollHeight>i.body.offsetHeight?(e=i.body.scrollWidth,t=i.body.scrollHeight):(e=i.body.offsetWidth,t=i.body.offsetHeight),o.innerHeight?(n=o.innerWidth,r=o.innerHeight):i.documentElement&&i.documentElement.clientHeight?(n=i.documentElement.clientWidth,r=i.documentElement.clientHeight):i.body&&(n=i.body.clientWidth,r=i.body.clientHeight);var a=Math.max(e,n),s=Math.max(t,r);return[a,s,n,r]},r={"uploadUrl":"/upload/image?https=true","showLowRepWarning":!1},i=function(){$(".wmd-prompt-background").remove()},o=function(){var e=window.document,t=(window.navigator,e.createElement("div")),r=t.style;t.className="wmd-prompt-background",r.position="absolute",r.top="0",r.zIndex="1000",r.opacity="0.5";var i=n();return r.height=i[1]+"px",r.left="0",r.width="100%",e.body.appendChild(t),t};return{"createImageUploadBackground":o,"removeImageUploadBackground":i,"enableLowRepWarning":function(){r.showLowRepWarning=!0},"uploadImageDialog":function(n,i){"string"===$.type(i)&&(i={"uploadUrl":i}),i=$.extend(r,i);var o,a="upload-iframe-"+(new Date).getTime(),s="/render/image-upload?uploadUrl={0}&showLowRepWarning={2}".formatUnicorn(encodeURIComponent(i.uploadUrl),i.showLowRepWarning?"true":"false"),c=$('<div class="modal image-upload wmd-prompt-dialog auto-center" tabindex="-1"></div>').addClass("async-load").data("load-url",s),u=0,l=function(e){c&&c.fadeOutAndRemove(),$("body").off("keydown",v.checkEscape).off("paste",v.paste),void 0!==e&&n(e)},f=function(e){return 0===e.type.indexOf("image/")},d=function(e){var t;return e.items&&(t=$.grep(e.items,f),t.length>0)?t[0].getAsFile():e.files&&(t=$.grep(e.files,f),t.length>0)?t[0]:void 0},h=function(e,t){var n=c.find("."+e);n.find(".tab-page").hide(),n.find("."+e+"-"+t).show(),n.data("active-tab",t)},p=function(e){var t=c.find("."+e);return t.data("active-tab")},g=function(){window.closeDialog=l,window.displayUploadError=m.uploadError},m={"resetInputs":function(){c.find(".modal-input-file, .modal-input-url").prop("disabled",!1).attr("value","")},"uploadError":function(e){m.resetInputs(),c.find(".modal-options-error .modal-options-error-message").text(e),h("modal-options","error")},"ajaxResult":function(e){$("#"+a).contents().find("html").html(e)},"ajaxError":function(e,t,n){m.uploadError(function(e){return"Request returned an error: ["+e.status+"] "+e.error}({"status":t,"error":n}))}},v={"showLink":function(e){e&&e.preventDefault(),h("modal-options","url"),c.find(".modal-input-url").focus()},"resetView":function(e){e&&e.preventDefault(),h("modal-dropzone","default"),h("modal-options","default"),c.find(".modal-cta-submit").prop("disabled",!0),c.find(".modal-dropzone-preview").empty(),c.find(".modal-input-file").val(""),m.resetInputs(),u=0,o.removeClass("hover"),c.find("form").off("submit").on("submit",v.oldSchoolSubmit),c.find("form input[name=fkey]").val(StackExchange.options.user.fkey)},"inputFileOrUrl":function(){var e=!!c.find(".user-input").filter(function(){return this.value.length}).length;c.find(".modal-cta-submit").prop("disabled",!e)},"disablePasteHandling":function(){$("body").off("paste",v.previewImage)},"enablePasteHandling":function(){$("body").on("paste",{"property":"clipboardData"},v.previewImage)},"selectFile":function(e){e.preventDefault(),c.find(".modal-input-file").click()},"clickFile":function(e){e.stopPropagation()},"previewImage":function(t){t.preventDefault();var n,r,i,o=d(t.originalEvent[t.data.property]);o&&(n=o.size>=2097152,r=c.find(".modal-dropzone-preview"),r.empty(),i=e.createObjectURL(o),$("<img>").attr("src",i).css({"maxWidth":r.css("width"),"maxHeight":r.css("height")}).on("load",{"url":i},v.loadPreviewImage).appendTo(r),c.find("form").off("submit").on("submit",o,v.ajaxSubmit),c.find(".modal-cta-submit").prop("disabled",n),h("modal-dropzone","preview"),h("modal-options",n?"toobig":"preview"))},"dragEnter":function(e){e.preventDefault(),u++,o.addClass("hover")},"dragLeave":function(){0===--u&&o.removeClass("hover")},"clickClose":function(e){e.preventDefault(),l(null)},"loadPreviewImage":function(t){e.revokeObjectURL(t.data.url)},"oldSchoolSubmit":function(e){var t="url"===p("modal-options");h("modal-options","uploading"),c.find(".modal-input-file").prop("disabled",t),c.find(".modal-input-url").prop("disabled",!t),e.target.target=a,g()},"ajaxSubmit":function(e){e.preventDefault(),h("modal-options","uploading");var t=new window.FormData;t.append("file",e.data),t.append("fkey",StackExchange.options.user.fkey),g(),$.ajax({"url":i.uploadUrl,"data":t,"cache":!1,"contentType":!1,"processData":!1,"type":"POST","success":m.ajaxResult,"error":m.ajaxError})},"checkEscape":function(e){27===e.which&&(e.preventDefault(),l(null))}},b=function(){c.css("height","auto"),c.find(".modal-options-uploading p").addSpinner(),c.find(".modal-options-default a").click(v.showLink),c.find(".modal-options-cancel").click(v.resetView),c.find(".modal-input-file").on("click",v.clickFile).on("change",v.inputFileOrUrl);var e=c.find(".modal-input-url").on("input keydown",v.inputFileOrUrl);c.find(".modal-dropzone-default").click(v.selectFile),c.find(".modal-input-file").change({"property":"target"},v.previewImage),c.find(".modal-input-url").focus(v.disablePasteHandling).blur(v.enablePasteHandling),v.enablePasteHandling(),o=c.find(".modal-dropzone-default").on("dragenter",v.dragEnter).on("dragleave",v.dragLeave).on("dragover",!1).on("drop",{"property":"dataTransfer"},v.previewImage),c.find(".modal-close").click(v.clickClose),v.resetView(),c.focus(),i.imageUrl&&(v.showLink(),e.val(i.imageUrl),v.inputFileOrUrl())},y=function(){c.asyncLoad({"callback":function(){w(c),b()},"cache":t})},w=function(e){$('<iframe style="display: none;" src="about:blank" />').attr("id",a).attr("name",a).appendTo(e)};return c.appendTo("body").center().fadeIn("fast").promise().done(y),c.on("popupClose",v.disablePasteHandling),$("body").on("keydown",v.checkEscape),!0}}}(),StackExchange.postValidation=function(){function e(e,t,n,r){var i=e.find('input[type="submit"]:visible, button[type="submit"]:visible'),f=i.length&&i.is(":enabled");f&&i.attr("disabled",!0),o(e,r),a(e,t,n,r),c(e),u(e),l(e);var d=function(){1!=t||e.find(E).length?(s(e,r),f&&i.attr("disabled",!1)):setTimeout(d,250)};d()}function t(t,o,a,s,c){e(t,o,s,a);var u,l=function(e){if(e.success)if(c)c(e);else{var n=window.location.href.split("#")[0],r=e.redirectTo.split("#")[0];0==r.indexOf("/")&&(r=window.location.protocol+"//"+window.location.hostname+r),u=!0,window.location=e.redirectTo,n.toLowerCase()==r.toLowerCase()&&window.location.reload(!0)}else e.captchaHtml?StackExchange.nocaptcha.init(e.captchaHtml,l):e.errors?(t.find("input[name=priorAttemptCount]").val(function(e,t){return(+t+1||0).toString()}),p(e.errors,t,o,a,e.warnings)):t.find('input[type="submit"]:visible, button[type="submit"]:visible').parent().showErrorMessage(e.message)};t.submit(function(){var e=t.find('input[type="submit"]:visible, button[type="submit"]:visible');if(t.find("#answer-from-ask").is(":checked"))return!0;var o=t.find(_);if("[Edit removed during grace period]"==$.trim(o.val()))return m(o,["Comment reserved for system use. Please use an appropriate comment."],f()),!1;if(i(),StackExchange.navPrevention&&StackExchange.navPrevention.stop(),e.parent().addSpinner(),StackExchange.helpers.disableSubmitButton(t),StackExchange.options.site.enableNewTagCreationWarning){var s=t.find(E).parent().find("input#tagnames"),c=s.prop("defaultValue");if(s.val()!==c)return $.ajax({"type":"GET","url":"/posts/new-tags-warning","dataType":"json","data":{"tags":s.val()},"success":function(e){if(e.showWarning){var i={"closeOthers":!0,"shown":function(){$(".js-confirm-tag-creation").on("click",function(e){return StackExchange.helpers.closePopups(),r(t,a,u,l),e.preventDefault(),!1})},"dismissing":function(){n(t,u)},"returnElements":$("#tagnames").parent().find("input:visible")};StackExchange.helpers.showModal($(e.html).elementNodesOnly(),i),StackExchange.helpers.bindMovablePopups()}else r(t,a,u,l)}}),!1}return setTimeout(function(){r(t,a,u,l)},0),!1})}function n(e,t){StackExchange.helpers.removeSpinner(),t||StackExchange.helpers.enableSubmitButton(e)}function r(e,t,r,i){$.ajax({"type":"POST","dataType":"json","data":e.serialize(),"url":e.attr("action"),"success":i,"error":function(){var n;switch(t){case"question":n="An error occurred submitting the question.";break;case"answer":n="An error occurred submitting the answer.";break;case"edit":n="An error occurred submitting the edit.";break;case"tags":n="An error occurred submitting the tags.";break;case"post":default:n="An error occurred submitting the post."}e.find('input[type="submit"]:visible, button[type="submit"]:visible').parent().showErrorMessage(n)},"complete":function(){n(e,r)}})}function i(){for(var e=0;e<A.length;e++)clearTimeout(A[e]);A=[]}function o(e,t){var n=e.find(k);n.length&&n.blur(function(){A.push(setTimeout(function(){var r=n.val(),i=$.trim(r);if(h(n),0==i.length)return y(e,n),void 0;var o=n.data("min-length");if(o&&i.length<o)return m(n,[function(e){return 1==e.minLength?"Title must be at least "+e.minLength+" character.":"Title must be at least "+e.minLength+" characters."}({"minLength":o})],f()),void 0;var a=n.data("max-length");return a&&i.length>a?(m(n,[function(e){return 1==e.maxLength?"Title cannot be longer than "+e.maxLength+" character.":"Title cannot be longer than "+e.maxLength+" characters."}({"maxLength":a})],f()),void 0):($.ajax({"type":"POST","url":"/posts/validate-title","data":{"title":r},"success":function(r){r.success?y(e,n):m(n,r.errors.Title,f()),"edit"!=t&&g(e,n,r.warnings.Title)},"error":function(){y(e,n)}}),void 0)},I))})}function a(e,t,n,r){var i=e.find(S);i.length&&i.blur(function(){A.push(setTimeout(function(){var o=i.val(),a=$.trim(o);if(h(i),0==a.length)return y(e,i),void 0;if(5==t){var s=i.data("min-length");return s&&a.length<s?m(i,[function(e){return"Wiki Body must be at least "+e.minLength+" characters. You entered "+e.actual+"."}({"minLength":s,"actual":a.length})],f()):y(e,i),void 0}(1==t||2==t)&&$.ajax({"type":"POST","url":"/posts/validate-body","data":{"body":o,"oldBody":i.prop("defaultValue"),"isQuestion":1==t,"isSuggestedEdit":n},"success":function(t){t.success?y(e,i):m(i,t.errors.Body,f()),"edit"!=r&&g(e,i,t.warnings.Body)},"error":function(){y(e,i)}})},I))})}function s(e,t){var n=e.find(E);if(n.length){var r=n.parent().find("input#tagnames");r.blur(function(){A.push(setTimeout(function(){var i=r.val(),o=$.trim(i);return 0==o.length?(y(e,n),void 0):($.ajax({"type":"POST","url":"/posts/validate-tags","data":{"tags":i,"oldTags":r.prop("defaultValue")},"success":function(r){if(r.success?y(e,n):m(n,r.errors.Tags,f()),"edit"!=t&&(g(e,n,r.warnings.Tags),r.source&&r.source.Tags&&r.source.Tags.length)){var i=$("#post-form input[name='warntags']");i&&StackExchange.using("gps",function(){var e=i.val()||"";$.each(r.source.Tags,function(t,n){n&&!i.data("tag-"+n)&&(i.data("tag-"+n,n),e=e.length?e+" "+n:n,StackExchange.gps.track("tag_warning.show",{"tag":n},!0))}),i.val(e),StackExchange.gps.sendPending()})}},"error":function(){y(e,n)}}),void 0)},I))})}}function c(e){var t=e.find(_);t.length&&t.blur(function(){A.push(setTimeout(function(){var n=t.val(),r=$.trim(n);if(0==r.length)return y(e,t),void 0;var i=t.data("min-length");if(i&&r.length<i)return m(t,[function(e){return 1==e.minLength?"Your edit summary must be at least "+e.minLength+" character.":"Your edit summary must be at least "+e.minLength+" characters."}({"minLength":i})],f()),void 0;var o=t.data("max-length");return o&&r.length>o?(m(t,[function(e){return 1==e.maxLength?"Your edit summary cannot be longer than "+e.maxLength+" character.":"Your edit summary cannot be longer than "+e.maxLength+" characters."}({"maxLength":o})],f()),void 0):(y(e,t),void 0)},I))})}function u(e){var t=e.find(T);t.length&&t.blur(function(){A.push(setTimeout(function(){var n=t.val(),r=$.trim(n);if(0==r.length)return y(e,t),void 0;var i=t.data("min-length");if(i&&r.length<i)return m(t,[function(e){return"Wiki Excerpt must be at least "+e.minLength+" characters; you entered "+e.actual+"."}({"minLength":i,"actual":r.length})],f()),void 0;var o=t.data("max-length");return o&&r.length>o?(m(t,[function(e){return"Wiki Excerpt cannot be longer than "+e.maxLength+" characters; you entered "+e.actual+"."}({"maxLength":o,"actual":r.length})],f()),void 0):(y(e,t),void 0)},I))})}function l(e){var t=e.find(j);t.length&&t.blur(function(){A.push(setTimeout(function(){var n=t.val(),r=$.trim(n);return 0==r.length?(y(e,t),void 0):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,20}$/i.test(r)?(y(e,t),void 0):(m(t,["This email does not appear to be valid."],d()),void 0)},I))})}function f(){var e=$("#sidebar, .sidebar").first().width()||270,t="lg"===StackExchange.responsive.currentRange();return{"position":{"my":t?"left top":"top center","at":t?"right center":"bottom center"},"css":{"max-width":e,"min-width":e},"closeOthers":!1}}function d(){var e=$("#sidebar, .sidebar").first().width()||270;return{"position":{"my":"left top","at":"right center"},"css":{"min-width":e},"closeOthers":!1}}function h(){Array.prototype.forEach.call(arguments,function(e){var t=StackExchange.stacksValidation.handlerFor(e);t&&t.clear()})}function p(e,t,n,r,i){if(e){var o=function(){var n=0,o=t.find(E),a=t.find(k),s=t.find(S),c=t.find(C);h(a,s,o,c),m(a,e.Title,f())?n++:y(t,a),i&&g(t,a,i.Title),m(s,e.Body,f())?n++:y(t,s),i&&g(t,s,i.Body),m(o,e.Tags,f())?n++:y(t,o),m(c,e.Mentions,f())?n++:y(t,c),i&&g(t,o,i.Tags),m(t.find(_),e.EditComment,f())?n++:y(t,t.find(_)),m(t.find(T),e.Excerpt,f())?n++:y(t,t.find(T)),m(t.find(j),e.Email,d())?n++:y(t,t.find(j)),m(t.find(M),e.Confirmation,f())?n++:y(t,t.find(M));var u=t.find(".general-error"),l=e.General&&e.General.length>0;if(l||n>0){if(!u.length){var p=t.find('input[type="submit"]:visible, button[type="submit"]:visible');p.parent().after('<div class="general-error-container"><div class="general-error"></div><br class="cbt" /></div>'),u=t.find(".general-error")}if(l)m(u,e.General,{"position":"inline","css":{"float":"left","margin-bottom":"10px"},"closeOthers":!1,"dismissable":!1});else{y(t,u);var v;switch(r){case"question":v=function(e){return 1==e.specificErrorCount?"Your question couldn't be submitted. Please see the error above.":"Your question couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"answer":v=function(e){return 1==e.specificErrorCount?"Your answer couldn't be submitted. Please see the error above.":"Your answer couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"edit":v=function(e){return 1==e.specificErrorCount?"Your edit couldn't be submitted. Please see the error above.":"Your edit couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"tags":v=function(e){return 1==e.specificErrorCount?"Your tags couldn't be submitted. Please see the error above.":"Your tags couldn't be submitted. Please see the errors above."}({"specificErrorCount":n});break;case"post":default:v=function(e){return 1==e.specificErrorCount?"Your post couldn't be submitted. Please see the error above.":"Your post couldn't be submitted. Please see the errors above."}({"specificErrorCount":n})}u.text(v)}}else t.find(".general-error-container").remove();var b;x()&&($("#sidebar").animate({"opacity":.4},500),b=setInterval(function(){x()||($("#sidebar").animate({"opacity":1},500),clearInterval(b))},500));var w;t.find(".validation-error, .js-stacks-validation.has-error").each(function(){var e=$(this).offset().top;(!w||w>e)&&(w=e)});var A=function(){for(var e=0;3>e;e++)t.find(".message").animate({"left":"+=5px"},100).animate({"left":"-=5px"},100)};if(w){var I=$(".review-bar").length;w=Math.max(0,w-(I?125:30)),$("html, body").animate({"scrollTop":w},A)}else A()},a=function(){1!=n||t.find(E).length?o():setTimeout(a,250)};a()}}function g(e,t,n){var r=f();if(r.type="warning",!n||0==n.length)return b(e,t),!1;var i=t.data("error-popup"),o=0;return i&&(o=i.height()+5),v(t,n,r,o)}function m(e,t,n){return n.type="error",v(e,t,n)}function v(e,t,n,r){var o,a=n.type,s=StackExchange.stacksValidation.handlerFor(e);if(s)return s.clear(a),(t||[]).forEach(function(e){s.add(a,e)}),!0;if(!(t&&0!=t.length&&e.length&&$("html").has(e).length))return!1;if(o=1==t.length?t[0]:"<ul><li>"+t.join("</li><li>")+"</li></ul>",o&&o.length>0){var c=e.data(a+"-popup");if(c&&c.is(":visible")){var u=e.data(a+"-message");if(u==o)return c.animateOffsetTop&&c.animateOffsetTop(r||0),!0;c.fadeOutAndRemove()}r>0&&(n.position.offsetTop=r);var l=StackExchange.helpers.showMessage(e,o,n);return l.find("a").attr("target","_blank"),l.click(i),e.addClass("validation-"+a).data(a+"-popup",l).data(a+"-message",o),!0}return!1}function b(e,t){w("warning",e,t)}function y(e,t){w("error",e,t)}function w(e,t,n){if(!n||0==n.length)return!1;var r=StackExchange.stacksValidation.handlerFor(n);r&&r.clear(e);var i=n.data(e+"-popup");return i&&i.is(":visible")&&i.fadeOutAndRemove(),n.removeClass("validation-"+e),n.removeData(e+"-popup"),n.removeData(e+"-message"),t.find(".validation-"+e+", .js-stacks-validation.has-"+e).length||t.find(".general-"+e+"-container").remove(),!0}function x(){var e=!1,t=$("#sidebar, .sidebar").first();if(!t.length)return!1;var n=t.offset().left;return $(".message").each(function(){var t=$(this);return t.offset().left+t.outerWidth()>n?(e=!0,!1):void 0}),e}var k="input#title",S="textarea.wmd-input:first",E=".tag-editor:not(.mention-editor)",C=".mention-editor",_="input[id^=edit-comment]",T="textarea#excerpt",j="input#m-address",M="label.ask-confirmation",A=[],I=250;return{"initOnBlur":e,"initOnBlurAndSubmit":t,"showErrorsAfterSubmission":p,"getSidebarPopupOptions":f}}(),StackExchange.wizardEditor=function(){var e,t=0,n=$(".js-post-form"),r=$(".js-wz-section-container"),i=$(".js-wz-section"),o=$(".js-wz-wrapper"),a=$(".js-wizard-header"),s=$(".js-wz-resizer-container"),c=$(".js-wz-resizer"),u=$(".js-wz-next"),l=$(".js-wz-previous"),f=$(".js-wz-style"),d=$(".js-wz-progress"),h=$(".js-wz-question-type-container"),p=$(".js-wz-screen"),g=$(".js-ask-title"),m=$("textarea.wmd-input:first"),v=$(".js-tag-editor"),b=$(".js-wz-qs-title"),y=$(".js-wz-qs-subtitle"),w=$(".js-wz-qs-footer"),x=$(".js-wz-draft-banner"),k=$(".js-wz-wip-banner"),S=!1,E=!1,C=!0,_=[],T={"form":!1,"review":!1,"editor":!1,"tags":!1,"title":!1,"navigation":!1,"enterKey":!1,"type":!1},j={"descriptionSummary":!1,"descriptionContext":!1,"descriptionCode":!1,"descriptionResults":!1},M={"statesAttributeKey":"data-wz-state","draft":{"title":"","tags":"","summary":"","context":"","code":"","results":"","body":""},"statesDisplayOrder":[],"states":{"tags":1,"title":2,"questionSuggestions":4,"description":8,"descriptionSummary":16,"descriptionContext":32,"descriptionCode":64,"descriptionResults":128,"review":256,"type":512},"initValidation":function(){},"initTags":function(){}},A=function(e){M.statesAttributeKey=e.statesAttributeKey||M.statesAttributeKey,M.draft=e.draft||M.draft,M.statesDisplayOrder=e.statesDisplayOrder||M.statesDisplayOrder,M.states=e.states||M.states,M.onEnterState=e.onEnterState,M.initValidation=e.initValidation,M.initTags=e.initTags,P(),nt(),rt(),it(),ut(),ct(),yt(),kt(),t=null!==window.history.state&&St(window.history.state)?window.history.state:M.states.type,D(),U(),window.addEventListener("popstate",function(e){D(e.state),U()}),window.history.replaceState(t,window.document.title,window.location.pathname)},I=function(t){e=t},P=function(){vt()&&(S=!0,g.val(M.draft.title),$(".js-wz-summary-input").val(M.draft.summary),$(".js-wz-context-input").val(M.draft.context),$(".js-wz-code-input").val(M.draft.code),$(".js-wz-results-input").val(M.draft.results),_=M.draft.tags.split(" "))},O=function(e,t){return $(e+"["+M.statesAttributeKey+"='"+t+"']")},D=function(e){t="number"!=typeof e?t:e,L()},L=function(){$(".js-wz-element").each(function(e,n){var r=$(n);r.removeClass("js-wz-element--active"),r.attr(M.statesAttributeKey).split(",").indexOf(t.toString())>-1&&r.addClass("js-wz-element--active")}),d.each(function(e,n){var r=$(n);r.removeClass("wz-progress--active"),r.attr(M.statesAttributeKey).split(",").indexOf(t.toString())>-1&&r.addClass("wz-progress--active")}),R(),t!==M.states.title&&t!==M.states.questionSuggestions&&$(".js-similar-questions-outer-div").addClass("d-none"),$(".message").remove()},R=function(){for(var e in j)O("textarea",M.states[e]).toggleClass("wz-section--active",!j[e]),O(".js-wz-icons",M.states[e]).toggleClass("wz-icons--active",!j[e])},q=function(e){Z(e),N(),D()},N=function(){$("#wmd-input").val(X()),e.refreshPreview()},U=function(){t===M.states.type&&(W(),B("wizard.enter_type")),t===M.states.tags&&(K(),B("wizard.enter_tags")),t===M.states.title&&(H(),B("wizard.enter_title")),t===M.states.questionSuggestions&&(G(),B("wizard.enter_questions_suggestions")),[M.states.description,M.states.descriptionCode,M.states.descriptionContext,M.states.descriptionSummary,M.states.descriptionResults].indexOf(t)>-1&&(Q(),t===M.states.description&&B("wizard.enter_editor")),t===M.states.review&&(tt(),B("wizard.enter_review")),z(),V(),F(),bt(),"undefined"!=typeof M.onEnterState&&M.onEnterState()},B=function(e){StackExchange.using("gps",function(){StackExchange.gps.track(e)})},F=function(){switch(t){case M.states.title:u.prop("disabled",g.val().length<15);break;case M.states.tags:u.prop("disabled",!_||0===_.length||_.length>5);break;default:u.removeAttr("disabled")}},z=function(){l.text(t===M.states.review?"Return to guided mode":"Previous")},V=function(){u.text(t===M.states.questionSuggestions&&C?"None of these answer my question":"Next")},H=function(){g.focus(),ht()},W=function(){dt(),ft()},K=function(){pt()},G=function(){Y()},Y=function(){var e=g.val();e.length>0?C?($(".js-similar-questions-outer-div").removeClass("d-none"),b.text("Do any of these answer your question?"),y.html(function(e){return"There may be similar questions that match your title: <b>&quot;"+e.title+"&quot;</b>"}({"title":e})),w.text("Tip: If none of those answer your question, tell us what you found (on this site or elsewhere) and why it didn’t meet your needs. You can get better answers when you provide research.")):(b.text("Your question is looking good so far"),y.html(function(e){return"Our search didn’t turn up any questions similar to: <b>&quot;"+e.title+"&quot;</b>"}({"title":e})),w.text("Tip: We check for similar questions based on your title and tags in case your issue already has an answer in another question.")):(b.text("Your question is looking good so far"),y.html("Enter a title and some tags and we’ll look for questions similar to yours."),w.text("Tip: We check for similar questions based on your title and tags in case your issue already has an answer in another question.")),V()
},Q=function(){T.editor||gt(),0===$(".js-wz-guided").length&&$("#wmd-button-bar").prepend('<span class="js-wz-guided ps-absolute fw-bold mtn1 t16 l12">Guided Mode</span>'),0===$(".js-wz-traditional-link").length&&($("#wmd-button-bar").append('<a class="js-wz-traditional-link ps-absolute mtn1 t16 r48 z-nav" href="#" class="js-gps-track" data-gps-track="wizard.switch_mode({ location: \'description\' })">Use traditional mode</a>'),$(".js-wz-traditional-link").click(function(){StackExchange.cardiologist.ensureDraftSaved(function(){window.location.href="/questions/ask?guided=false"},!0)})),$(".wmd-button:not(.wmd-help-button)").css("visibility","hidden"),i.each(function(e,t){Z($(t))}),J(),E&&(S=!1),L(),O("textarea",M.states.descriptionSummary).focus()},J=function(){var e=X(),t=$("#wmd-input").val().trim();t!==e&&(i.each(function(e,n){var r=$(n);parseInt(r.attr(M.statesAttributeKey))===M.states.descriptionSummary?r.val(t):r.val("")}),j.descriptionSummary=!1,j.descriptionContext=!0,j.descriptionCode=!0,j.descriptionResults=!0,E=!0)},X=function(){var e="";return i.each(function(t,n){var r=$(n),i=r.val();i.length>0&&(e+=i+"\n\n")}),e.trim()},Z=function(e){var t=$(e);s.css("width",t.outerWidth());var n=t.val();c.text(n.length>0?n.endsWith("\n")?n+" ":n:" ");var r=c.outerHeight();e===i[0]&&(r+=5),t.css("height",r)},et=function(){r.removeClass("focused"),$(".js-wz-"+t+"-container").addClass("focused"),o.removeClass("wz-wrapper--focused"),O(".js-wz-wrapper",t).addClass("wz-wrapper--focused")},tt=function(){$(".wmd-button").css("visibility","visible"),$(".js-wz-guided").remove(),$(".js-wz-traditional-link").remove(),S=!1,E=!1,mt(),[g,m,v].forEach(function(e){e.focus().blur()})},nt=function(){T.form||(n.submit(function(e){t!==M.states.review&&e.preventDefault()}),T.form=!0)},rt=function(){T.navigation||(d.click(function(e){var n=$(e.target).attr(M.statesAttributeKey).split(",");if(n.length>0){var r=parseInt(n[0]);D(r),U(),$(window).scrollTop(0),window.history.pushState(t,window.document.title,window.location.pathname)}}),T.navigation=!0)},it=function(){T.enterKey||($(document).keydown(function(e){return t<M.states.description&&13===e.which?(u.is(":disabled")?null:lt(),void 0):void 0}),T.enterKey=!0)},ot=function(){return[M.states.description,M.states.descriptionCode,M.states.descriptionContext,M.states.descriptionResults,M.states.descriptionSummary]},at=function(){var e=M.statesDisplayOrder.indexOf(t);D(e>-1&&e<M.statesDisplayOrder.length-2?M.statesDisplayOrder[e+1]:t)},st=function(){var e=M.statesDisplayOrder.indexOf(t);D(e>0&&e<M.statesDisplayOrder.length-1?M.statesDisplayOrder[e-1]:t)},ct=function(){l.click(function(){ot().indexOf(t)>-1?D(M.states.questionSuggestions):st(),U(),window.history.pushState(t,window.document.title,window.location.pathname)})},ut=function(){u.click(lt),F()},lt=function(){$(window).scrollTop(0),ot().indexOf(t)>-1?D(M.states.review):at(),U(),window.history.pushState(t,window.document.title,window.location.pathname)},ft=function(){function e(){t.is(":checked")&&n.prop("disabled",!1)}if(!T.type){var t=$(".js-wz-radio"),n=$(".js-wz-question-type"),r=$(".js-wz-type-previous");$(document).ready(e),t.change(e),n.click(function(){var e=$(".js-wz-radio:checked").val();return StackExchange.using("gps",function(){StackExchange.gps.track("wizard.question_type",{"question_type":e})}),p.addClass("d-none"),$(".js-wz-"+e).removeClass("d-none"),!1}),r.click(function(){dt()}),$(".js-wz-sites-button").click(function(){p.addClass("d-none"),$(".js-wz-sites").removeClass("d-none")}),$(".js-wz-other-next").click(function(){p.addClass("d-none"),$(".js-wz-code").removeClass("d-none")}),$(".js-wz-type-next").click(function(){lt()}),T.type=!0}},dt=function(){$(".js-wz-screen").addClass("d-none"),h.removeClass("d-none")},ht=function(){T.title||(g.on("input",function(){F()}),T.title=!0)},pt=function(){T.tags||($("#tagnames").on("tageditor:renderedchange",function(e,t){_=t,F()}),M.initTags&&M.initTags(),T.tags=!0)},gt=function(){T.editor||(a.click(function(e){t=parseInt($(e.currentTarget).attr(M.statesAttributeKey));for(var n in M.states)M.states[n]===t&&(j[n]=!j[n],j[n]?t=M.states.description:(L(),O("textarea",t).focus()));L(),et()}),i.on("focus",function(e){t=parseInt($(e.currentTarget).attr(M.statesAttributeKey)),L(),et()}).on("input",function(e){q(e.target)}).each(function(e){var t=$(e.target);t.css("min-height",t.outerHeight())}),T.editor=!0)},mt=function(){T.review||($(".js-wz-previous-review").click(function(){confirm("If you return to Guided Mode, you will lose any changes you made during the review step. Are you sure you want to go back?")&&(st(),U())}),f.remove(),M.initValidation&&M.initValidation(),T.review=!0)},vt=function(){if(!M.draft)return!1;for(var e in M.draft)if(M.draft[e]&&M.draft[e].length>0)return!0;return!1},bt=function(){S&&t<M.states.review?(x.removeClass("d-none"),yt()):x.addClass("d-none"),E&&t>=M.states.description&&t<=M.states.descriptionSummary?(k.removeClass("d-none"),wt()):k.addClass("d-none")},yt=function(){S&&$(".js-wz-draft-banner-close").click(function(){x.remove()})},wt=function(){E&&$(".js-wz-wip-banner-close").click(function(){k.addClass("d-none")})},xt=function(){g.val(""),m.val(""),i.val(""),x.remove(),D(M.statesDisplayOrder[0])},kt=function(){var e=$("#submit-button");e.click(function(e){var n=$(e.target);n.preventDefault(),t===M.states.review&&confirm("Are you sure you want to submit your post?")&&n.submit()})},$t=function(e){C=e,Y()},St=function(e){for(var t in M.states)if(M.states[t]===e)return!0;return!1};return{"init":A,"initEditor":I,"onDraftDiscarded":xt,"onTitleSearchResults":$t}}();